<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>ansible playbook 从入门到放弃 - 小炒肉</title><meta name=Description content="ansible playbook 从入门到放弃"><meta property="og:title" content="ansible playbook 从入门到放弃"><meta property="og:description" content="ansible playbook 从入门到放弃"><meta property="og:type" content="article"><meta property="og:url" content="https://jicki.cn/ansible-playbook/"><meta property="og:image" content="https://jicki.cn/logo.png"><meta property="article:published_time" content="2020-08-10T00:00:00+00:00"><meta property="article:modified_time" content="2020-08-10T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://jicki.cn/logo.png"><meta name=twitter:title content="ansible playbook 从入门到放弃"><meta name=twitter:description content="ansible playbook 从入门到放弃"><meta name=application-name content="小炒肉"><meta name=apple-mobile-web-app-title content="小炒肉"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=/images/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://jicki.cn/ansible-playbook/><link rel=prev href=https://jicki.cn/gitops-kubernetes/><link rel=next href=https://jicki.cn/golang-study-web-notes/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"ansible playbook 从入门到放弃","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/jicki.cn\/ansible-playbook\/"},"genre":"posts","keywords":"linux, ansible","wordcount":3394,"url":"https:\/\/jicki.cn\/ansible-playbook\/","datePublished":"2020-08-10T00:00:00+00:00","dateModified":"2020-08-10T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"小炒肉"},"description":"ansible playbook 从入门到放弃"}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':('auto'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'auto'==='dark'))&&document.body.setAttribute('theme','dark');</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=小炒肉>小炒肉</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>文章 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><a class=menu-item href=/about/>关于 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw"></i></a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw"></i></a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span></span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=小炒肉>小炒肉</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw"></i></a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw"></i></a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts/>文章</a><a class=menu-item href=/tags/>标签</a><a class=menu-item href=/categories/>分类</a><a class=menu-item href=/about/>关于</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">ansible playbook 从入门到放弃</h1><h2 class=single-subtitle>ansible playbook 从入门到放弃</h2><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://jicki.cn title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw"></i>小炒肉</a></span>&nbsp;<span class=post-category>收录于 <a href=/categories/linux/><i class="far fa-folder fa-fw"></i>linux</a>&nbsp;<a href=/categories/ansible/><i class="far fa-folder fa-fw"></i>ansible</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2020-08-10>2020-08-10</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 3394 字&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 7 分钟&nbsp;<span id=/ansible-playbook/ class=leancloud_visitors data-flag-title="ansible playbook 从入门到放弃">
<i class="far fa-eye fa-fw"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;次阅读
</span>&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#ansible-简介>ansible 简介</a></li><li><a href=#ansible-架构>ansible 架构</a></li><li><a href=#ansible-安装>ansible 安装</a></li><li><a href=#etcansiblehosts>/etc/ansible/hosts</a></li><li><a href=#etcansibleansiblecfg>/etc/ansible/ansible.cfg</a></li><li><a href=#ansible-命令>ansible 命令</a><ul><li><a href=#ansible-doc>ansible-doc</a></li><li><a href=#ansible-1>ansible</a></li><li><a href=#ansible-常用模块>ansible 常用模块</a></li></ul></li><li><a href=#ansible-执行过程>ansible 执行过程</a></li></ul></nav></div></div><div class=content id=content><figure><img src=/img/posts/ansible/ansible.png></figure><h1 id=前言>前言</h1><p><strong>运维自动化的发展历程以及技术应用</strong></p><ol><li>本地部署 <code>On-Premises</code> 如下都需要自己 <code>部署/配置</code> 以及维护。</li></ol><ul><li><code>Application</code></li><li><code>Data</code></li><li><code>Runtime</code></li><li><code>Middleware</code></li><li><code>OS</code></li><li><code>Virtualization</code></li><li><code>Servers</code></li><li><code>Storage</code></li><li><code>NetWorking</code></li></ul><ol start=2><li>基础设施既服务 ( 如 阿里云 ) <code>IaaS</code> - <code>Infrastructure as a Service</code> 如下需要自己 <code>部署/配置</code> 以及维护。</li></ol><ul><li><code>Application</code></li><li><code>Data</code></li><li><code>Runtime</code></li><li><code>Middleware</code></li><li><code>OS</code></li></ul><ol start=3><li>平台既服务 ( 如 阿里云- ACK 容器服务 ) <code>PaaS</code> - <code>Platform as a Service</code> 如下需要自己 <code>部署/配置</code> 以及维护。</li></ol><ul><li><code>Application</code></li><li><code>Data</code></li></ul><ol start=4><li>软件既服务 ( 如 各类软件 微信、钉钉、邮箱 ) <code>SaaS</code> - <code>Software as a Service</code> 所有的服务软件都不需要自己维护, 直接使用既可。</li></ol><h1 id=ansible>ansible</h1><h2 id=ansible-简介>ansible 简介</h2><blockquote><p>ansible 是基于 <code>python2-paramiko</code> 模块开发的自动化运维工具。 实现了批量系统配置, 批量程序部署, 批量运行命令等功能。<code>ansible</code> 是基于模块工作的, 本身没有批量部署的能力。真正具有批量部署的是 <code>ansible</code> 所运行的模块, <code>ansible</code> 只是提供了一种框架。</p></blockquote><p><strong>ansible 集合了众多运维工具（ pupet、cfengine、chef、func、fabric、saltstack ）的优点</strong></p><ul><li><p>ansible 发展史</p><ul><li><p>ansible 作者是 <code>Michael DeHaan</code> 同时他也是 <code>Cobbler 与 Func</code> 作者。</p></li><li><p>2012-03-09 发布 0.0.1 版本。</p></li><li><p>2015-10-17 被 <code>Red Hat</code> 收购。</p></li></ul></li><li><p>ansible 特性</p><ul><li><p>基于 Python 开发</p></li><li><p>模块化: 调用特定的模块(如: Paramiko、PyYAML、jinja2 等), 完成特定的任务。</p></li><li><p>支持自定义模块</p></li><li><p>部署简单, 基于<code>Linux</code>内置的 <code>Python</code> 、<code>Open-SSH</code> 和另一个 <code>agentless</code> 组件.</p></li><li><p>支持 <code>PlayBook</code> 编排任务</p></li><li><p>幂等性: 任务重复执行等于只执行一次, 不会重复执行多次相同命令。</p></li><li><p>无需代理不依赖PKI.</p></li><li><p>支持多语言模块编写.</p></li><li><p><code>YAML</code>格式编排任务,支持丰富的数据结构.</p></li></ul></li></ul><h2 id=ansible-架构>ansible 架构</h2><figure><img src=/img/posts/ansible/ansible-jg.png></figure><figure><img src=/img/posts/ansible/ansible-yl.png></figure><ul><li><p><code>ansible</code> 主要组成部分:</p><ul><li><p><code>ansible playbooks</code>: 任务剧本(任务集), 通过编排定义<code>ansible</code>任务集合的配置文件, 由<code>ansible</code> 顺序依次执行, 文件通常是 <code>JSON</code>格式的<code>YML</code>文件。</p></li><li><p><code>Roles</code>: 角色, 多个 <code>ansilbe playbooks</code> 的集合.</p></li><li><p><code>Inventory</code>: <code>ansible</code> 管理主机的清单 默认为 <code>/etc/ansible/hosts</code> 文件。</p></li><li><p><code>Modules</code>: <code>ansible</code> 执行命令的功能模块, 一般为<code>ansible</code>内置核心模块, 也可以自定义第三方模块.</p></li><li><p><code>plugins</code>: <code>ansible</code> 功能插件, 是功能模块的补充. 如: 连接类型插件、循环插件、变量插件、过滤插件等等.</p></li><li><p><code>Api</code>: 提供第三方程序调用的开放接口.</p></li><li><p><code>ansible</code>: <code>ansible</code> 的客户端命令工具. 执行 <code>ansible</code> 命令的主要程序.</p><ul><li><p><code>Ad-Hoc</code> 用户执行单条或多条的 <code>ansible</code> 命令.</p></li><li><p><code>ansible playbook</code> 通过编写编排文件 <code>ansible</code> 执行命令集合.</p><ul><li><code>ansible playbook</code> 执行过程 -> 将编排好的任务写入 <code>ansible-playbook</code> 编排文件中 -> 通过 <code>ansible-playbook</code> 命令拆分任务集合, 然后按照预定的顺序逐条执行<code>ansible</code> 命令.</li></ul></li></ul></li></ul></li></ul><h2 id=ansible-安装>ansible 安装</h2><ul><li><p><code>ansible</code> 安装很简单, 也有很多种方式.</p><ul><li><p>安装 <code>epel</code> 源以后 执行 <code>yum -y install ansible</code></p></li><li><p>使用 源码包 进行 安装</p></li><li><p>通过 <code>git clone https://github.com/ansible/ansible</code> 以后进行安装</p></li><li><p>使用 pip 命令安装</p></li></ul></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>
<span class=o>[</span>root@jicki ~<span class=o>]</span><span class=c1># ansible --version</span>
ansible 2.9.10
  config <span class=nv>file</span> <span class=o>=</span> /etc/ansible/ansible.cfg
  configured module search <span class=nv>path</span> <span class=o>=</span> <span class=o>[</span>u<span class=s1>&#39;/root/.ansible/plugins/modules&#39;</span>, u<span class=s1>&#39;/usr/share/ansible/plugins/modules&#39;</span><span class=o>]</span>
  ansible python module <span class=nv>location</span> <span class=o>=</span> /usr/lib/python2.7/site-packages/ansible
  executable <span class=nv>location</span> <span class=o>=</span> /usr/bin/ansible
  python <span class=nv>version</span> <span class=o>=</span> 2.7.5 <span class=o>(</span>default, Apr  <span class=m>2</span> 2020, 13:16:51<span class=o>)</span> <span class=o>[</span>GCC 4.8.5 <span class=m>20150623</span> <span class=o>(</span>Red Hat 4.8.5-39<span class=o>)]</span>

</code></pre></td></tr></table></div></div><ul><li><p><code>ansible</code> 相关说明</p><ul><li><p><code>/etc/ansible/ansible.cfg</code> 主配置文件, 配置<code>ansible</code>的工作特性.</p></li><li><p><code>/etc/ansible/hosts</code> 主机清单.</p></li><li><p><code>/etc/ansible/roles/</code> 存放(roles)角色的目录.</p></li><li><p><code>/usr/bin/ansible</code> 二进制执行文件, <code>ansible</code> 主程序.</p></li><li><p><code>/usr/bin/ansilbe-doc</code> 配置文档, 模块功能查看工具.</p></li><li><p><code>/usr/bin/ansible-galaxy</code> 用于上传/下载 <code>roles</code> 模块到官方平台的工具.</p></li><li><p><code>/usr/bin/ansible-playbook</code> 自动化任务、编排剧本工具<code>/usr/bin/ansible-pull</code> 远程执行命令的工具.</p></li><li><p><code>/usr/bin/ansible-vault</code> 文件(如: playbook 文件) 加密工具.</p></li><li><p><code>/usr/bin/ansible-console</code> 基于 界面的用户交互执行工具.</p></li></ul></li></ul><h2 id=etcansiblehosts>/etc/ansible/hosts</h2><blockquote><p>创建秘钥 <code>ssh-keygen -t rsa -f ~/.ssh/id_rsa -C "jicki"</code></p><p>拷贝秘钥到其他被控端 <code>ssh-copy-id ip</code></p></blockquote><p><strong>主机清单文件</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell><span class=c1># #号为注释</span>

<span class=c1># 单主机 直接写入 ip 或 nameserver</span>
192.168.168.10

<span class=c1># 非标准22端口可直接用 : 填入</span>
192.168.168.10:999
db1.example.com:999


<span class=c1># []包含的为主机组 如下</span> 
<span class=o>[</span>webservers<span class=o>]</span>
192.168.168.10
192.168.168.11
192.168.168.12
192.168.168.13


<span class=c1># 主机也支持 nameserver 如下</span>
<span class=o>[</span>dbservers<span class=o>]</span>
db1.example.com
db2.example.com
db3.example.com
db4.example.com

<span class=c1># 主机支持 [1:10] 类型的多主机 如下</span> 
<span class=o>[</span>docker<span class=o>]</span>
<span class=c1># 等同于 192.168.168.10 ~ 192.168.168.120</span>
192.168.168.1<span class=o>[</span>0:20<span class=o>]</span>


<span class=c1># 主机也支持 [a:z] 类型的 nameserver 如下</span>
<span class=o>[</span>kubernetes<span class=o>]</span>
<span class=c1># 等同于 master-a ~ master-c</span>
master-<span class=o>[</span>a:c<span class=o>]</span>
<span class=c1># 等同于 node-c ~ node-g</span>
node-<span class=o>[</span>c:g<span class=o>]</span>

</code></pre></td></tr></table></div></div><ul><li><p>操作主机</p><ul><li><p><code>-m</code> 为指定模块 <code>ping</code> 为 模块名称</p></li><li><p><code>-k</code> 为密码方式, 默认为 ssh-key 免密码方式登录</p></li></ul></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell><span class=c1># ansible 通过 单主机进行操作 ( -k 为用户密码方式, 默认为 ssh-key )</span>
ansible 192.168.168.10 -m ping -k


<span class=c1># ansible 通过 &#39;:&#39; 组合进行操作</span>
ansible <span class=s2>&#34;192.168.168.10:192.168.168.20&#34;</span> -m ping -k


<span class=c1># ansible 通过 通配符加主机 进行操作</span>
ansible 192.168.168.* -m ping -k


<span class=c1># ansible 通过 hosts 组名称 进行操作</span>
ansible webservers -m ping -k


<span class=c1># ansible 通过 &#39;:&#39; 组合组进行操作</span>
ansible <span class=s1>&#39;webservers:dbservers&#39;</span> -m ping -k


<span class=c1># ansible 通过 通配符 进行操作</span>
ansible <span class=s1>&#39;*servers&#39;</span> -m ping -k


<span class=c1># ansible 通过 &#39;:&amp;&#39; 逻辑与 (两个组中都包含的主机)</span>
ansible <span class=s1>&#39;webservers:&amp;dbservers&#39;</span> -m ping -k


<span class=c1># ansible 通过 &#39;:!&#39; 逻辑非 (在webservers 但不在 dbservers的主机)</span>
ansible <span class=s1>&#39;webservers:!dbservers&#39;</span> -m ping -k


<span class=c1># ansible 也支持多逻辑的组合</span>
ansible <span class=s1>&#39;webservers:dbserver:&amp;appserver:!ftpservers&#39;</span> -m ping -k


<span class=c1># ansible 也支持正则表达式</span>
ansible <span class=s1>&#39;~(web|db)serever&#39;</span> -m ping -k


<span class=c1># ansible 通过 all 对 hosts 清单下所有主机进行操作</span>
ansible all -m ping -k


<span class=c1># ansible 通过 通配符 对 hosts 清单下所有主机进行操作</span>
ansible <span class=s1>&#39;*&#39;</span> -m ping -k

</code></pre></td></tr></table></div></div><ul><li>输出结果</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell><span class=o>[</span>root@jicki opt<span class=o>]</span><span class=c1># ansible all -m ping</span>
10.0.3.13 <span class=p>|</span> <span class=nv>SUCCESS</span> <span class=o>=</span>&gt; <span class=o>{</span>
    <span class=s2>&#34;ansible_facts&#34;</span>: <span class=o>{</span>
        <span class=s2>&#34;discovered_interpreter_python&#34;</span>: <span class=s2>&#34;/usr/bin/python&#34;</span>
    <span class=o>}</span>,
    <span class=s2>&#34;changed&#34;</span>: false,
    <span class=s2>&#34;ping&#34;</span>: <span class=s2>&#34;pong&#34;</span>
<span class=o>}</span>
</code></pre></td></tr></table></div></div><h2 id=etcansibleansiblecfg>/etc/ansible/ansible.cfg</h2><p><strong>ansible 主配置文件</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell><span class=c1># defaults 为默认配置</span>
<span class=o>[</span>defaults<span class=o>]</span>

<span class=c1># 主机清单的路径, 默认为如下</span>
<span class=c1>#inventory      = /etc/ansible/hosts</span>

<span class=c1># 模块存放的路径</span> 
<span class=c1>#library        = /usr/share/my_modules/</span>

<span class=c1># utils 模块存放路径</span>
<span class=c1>#module_utils   = /usr/share/my_module_utils/</span>

<span class=c1># 远程主机脚本临时存放目录</span>
<span class=c1>#remote_tmp     = ~/.ansible/tmp</span>

<span class=c1># 管理节点脚本临时存放目录</span> 
<span class=c1>#local_tmp      = ~/.ansible/tmp</span>

<span class=c1># 插件的配置文件路径</span>
<span class=c1>#plugin_filters_cfg = /etc/ansible/plugin_filters.yml</span>

<span class=c1># 执行并发数</span>
<span class=c1>#forks          = 5</span>

<span class=c1># 异步任务查询间隔 单位秒</span>
<span class=c1>#poll_interval  = 15</span>

<span class=c1># sudo 指定用户</span>
<span class=c1>#sudo_user      = root</span>

<span class=c1># 运行 ansible 是否提示输入sudo密码</span>
<span class=c1>#ask_sudo_pass = True</span>

<span class=c1># 运行 ansible 是否提示输入密码 同 -k</span>
<span class=c1>#ask_pass      = True</span>

<span class=c1># 远程传输模式</span>
<span class=c1>#transport      = smart</span>

<span class=c1># SSH 默认端口</span>
<span class=c1>#remote_port    = 22</span>

<span class=c1># 模块运行默认语言环境</span>
<span class=c1>#module_lang    = C</span>


<span class=c1># roles 存放路径</span>
<span class=c1>#roles_path    = /etc/ansible/roles</span>

<span class=c1># 不检查 /root/.ssh/known_hosts 文件 建议取消</span>
<span class=c1>#host_key_checking = False</span>


<span class=c1># ansible 操作日志路径 建议打开</span>
<span class=c1>#log_path = /var/log/ansible.log</span>


</code></pre></td></tr></table></div></div><h2 id=ansible-命令>ansible 命令</h2><h3 id=ansible-doc>ansible-doc</h3><ul><li><p>显示模块帮助</p><ul><li><p><code>-l, --list</code> 列出可用模块</p></li><li><p><code>-s, --snippet</code> 显示指定模块的 <code>playbook</code> 片段</p></li></ul></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell><span class=c1># 例子</span>

ansible-doc -l

ansible-doc ping

ansible-doc -s ping

</code></pre></td></tr></table></div></div><h3 id=ansible-1>ansible</h3><ul><li><p><code>ansible &lt;host-pattern> [-m module_name] [-a args]</code></p><ul><li><p><code>host-pattern</code>: 主机ip、主机名、主机组。</p></li><li><p><code>module_name</code>: 模块的名称。如果不写 默认为 <code>-m command</code> 。</p></li><li><p><code>args</code>: 模块的参数, 需要加上 <code>-a</code> 进行指定模块的参数。如: `ansible all -a &lsquo;hostname&rsquo;</p></li><li><p><code>-v、-vv、-vvv</code>: 显示详细的命令输出日志, v 越多越详细。如: <code>ansible all -m ping -vvv</code></p></li><li><p><code>--list</code>: 显示主机的列表。 如: <code>ansible all --list</code></p></li><li><p><code>-k / --ask-pass</code>: 提示输入ssh连接密码, 默认为 ssh-key 认证。如: <code>ansible all -m ping -k</code></p></li><li><p><code>-K / --ask-become-pass</code>: 提示输入 sudo 的密码。</p></li><li><p><code>-C / --check</code>: 检查命令操作, 并不会执行。如: <code>ansible all -m ping -C</code></p></li><li><p><code>-T / --timeout</code>: 执行命令的超时时间, 默认为 10s。如: <code>ansible all -m ping -T=2</code></p></li><li><p><code>-u / --user</code>: 执行远程操作的用户. 如: <code>ansible all -m ping -u=root</code></p></li><li><p><code>-b / --become</code>: 代替旧版的 <code>sudo</code> 切换。</p></li></ul></li></ul><h3 id=ansible-常用模块>ansible 常用模块</h3><blockquote><p>截止 2020-08-10 ansible 模块为 3387 个.</p></blockquote><ul><li><p><code>command</code> 模块: 在远程主机上执行命令, 支持条件判断. ansible 默认模块, 可忽略 <code>-m</code> 参数直接操作. 注: <code>command</code> 模块 不支持 <code>$VARNAME</code> <code>&lt;</code> <code>></code> <code>|</code> <code>;</code> <code>&</code> 等符号.</p><ul><li><p>`ansible all -m command -a &lsquo;systemctl stop docker&rsquo;</p></li><li><p>`ansible all -a &lsquo;docker ps -a&rsquo;</p></li><li><p><code>ansible all -a 'removes=/opt/ansible df -h'</code></p><ul><li>如果 /opt/ansible 不存在 就不执行 <code>df -h</code> 操作, 如果 /opt/ansible 存在, 就执行 <code>df -h</code> 操作.</li></ul></li><li><p><code>ansible all -a 'creates=/opt/ansible df -h'</code></p><ul><li>如果 /opt/ansible 不存在 就执行 <code>df -h</code> 操作, 如果存在 /opt/ansible 就不执行 <code>df -h</code> 操作.</li></ul></li><li><p><code>ansible all -a 'chdir=/opt ls -lt'</code></p><ul><li>切换目录, 等于 <code>cd /opt && ls -lt</code> 操作</li></ul></li></ul></li></ul><hr><ul><li><p><code>shell</code> 模块: shell 模块支持 command 所有的操作, 而且支持 <code>$VARNAME</code> <code>&lt;</code> <code>></code> <code>|</code> <code>;</code> <code>&</code> 等符号操作.</p><ul><li><code>ansible all -m shell -a 'ps -ef|grep docker'</code></li></ul></li></ul><hr><ul><li><p><code>script</code> 模块: 执行脚本的命令. 只需要调用 ansible 本机上的脚本就可以在所有的选择主机上面执行脚本中的内容.</p><ul><li><p><code>ansible all -m script -a '/root/1.sh'</code></p><ul><li><code>/root/1.sh</code> 脚本只需要在 ansible 管理主机上既可.</li></ul></li></ul></li></ul><hr><ul><li><p><code>copy</code> 模块: 拷贝文件到远程主机.</p><ul><li><p>`ansible all -m copy -a &lsquo;src=/root/xxx.txt dest=/root/1.txt backup=yes&rsquo;</p><ul><li><p><code>src</code>: 原文件路径</p></li><li><p><code>dest</code>: 目标主机路径</p></li><li><p><code>backup</code>: 如果目标主机文件存在, 会先进行备份, 再进行覆盖.</p></li></ul></li><li><p><code>ansible all -m copy -a 'src=/root/1.txt dest=/root/2.txt mode=0644 owner=jicki group=jicki'</code></p><ul><li><p><code>mode</code>: 修改权限</p></li><li><p><code>owner</code>: 修改用户</p></li><li><p><code>group</code>: 修改用户组</p></li></ul></li><li><p><code>ansible all -m copy -a 'content="hello\nworld\n" dest=/root/2.txt'</code></p><ul><li><code>content</code>: 将内容写入到目标文件中.</li></ul></li></ul></li></ul><hr><ul><li><p><code>fetch</code> 模块: 将远程主机的文件, 下载到本机中, 下载成功会存放在以 主机 IP/名称 的文件夹中, 会包含原文件的整体路径. (只能下载单个文件, 不支持目录, 可先打包成压缩包, 再进行下载)</p><ul><li><p><code>ansible all -m fetch -a 'src=/var/log/messages dest=/root/'</code></p><ul><li><p><code>src</code>: 远程主机的文件路径</p></li><li><p><code>dest</code>: 本机的文件夹路径</p></li></ul></li></ul></li></ul><hr><ul><li><p><code>file</code> 模块: 操作远程主机的文件. 如: 创建文件 <code>touch</code>、 删除文件 <code>absent</code> 等</p><ul><li><p><code>ansible all -m file -a 'name=/root/1.txt owner=jicki group=jicki mode=0755'</code></p><ul><li><p><code>mode</code>: 修改权限</p></li><li><p><code>owner</code>: 修改用户</p></li><li><p><code>group</code>: 修改用户组</p></li></ul></li><li><p><code>ansible all -m file -a 'name=/root/1.txt state=touch'</code></p><ul><li><p><code>dest</code>、<code>name</code>、<code>path</code>: 指定远程主机的文件路径.</p></li><li><p><code>state</code>: 文件操作类型.</p><ul><li><code>touch</code>: 创建空文件.</li><li><code>directory</code>: 创建文件夹.</li><li><code>absent</code>: 递归删除文件夹/文件.</li><li><code>link</code>: 创建软连接.</li></ul></li></ul></li><li><p>`ansible all -m file -a &lsquo;src=/root/1.txt dest=/root/1.link state=link&rsquo;</p><ul><li><code>src</code>: 源文件, 这里用于指定 软连接的源文件.</li></ul></li></ul></li></ul><hr><ul><li><p><code>cron</code> 模块: 为远程主机添加定时任务.</p><ul><li><p><code>ansible all -m cron -a 'weekday=1-5 job="echo </code>date<code> >> /root/1.txt" name=echocron'</code></p><ul><li><p><code>day</code>: 表示 天. 支持 ( 1-31, *, */2 ) 写法</p></li><li><p><code>hour</code>: 表示 小时. 支持 ( 0-23, *, */2 ) 写法</p></li><li><p><code>minute</code>: 表示 分钟. 支持 ( 0-59, *, */2 ) 写法</p></li><li><p><code>month</code>: 表示 月. 支持 ( 1-12, *, */2 ) 写法</p></li><li><p><code>weekday</code>: 表示 星期. 支持 ( 0-6, Sunday-Saturday, * )写法</p></li><li><p><code>job</code>: 表示 计划任务的内容.</p></li><li><p><code>name</code>: 表示 计划任务名称. 相同的计划任务名称会覆盖.</p></li></ul></li><li><p><code>ansible all -m cron -a 'disabled=true job="echo </code>date` &#187; /root/1.txt&rdquo; name=echocron&rsquo;</p><ul><li><p><code>disabled</code>: 只是注释掉计划任务 并非删除.</p><ul><li><code>true</code>、<code>yes</code> : 关闭计划任务. 关闭计划任务 必须指定 <code>job</code> 和 <code>name</code>.</li><li><code>false</code>、<code>no</code>: 重新打开计划任务. 必须指定 <code>job</code> 和 <code>name</code>.</li></ul></li></ul></li><li><p>ansible all -m cron -a &lsquo;name=echocron state=absent&rsquo;</p><ul><li><code>state</code><ul><li><code>absent</code> 删除计划任务. 删除计划任务 只需要指定 <code>name</code> 既可.</li></ul></li></ul></li></ul></li></ul><h2 id=ansible-执行过程>ansible 执行过程</h2><ol><li><p>加载配置文件 <code>/etc/ansible/ansible.cfg</code>.</p></li><li><p>加载对应的模块文件.</p></li><li><p>通过 ansible 将模块或命令生成对应的临时 <code>py</code> 文件, 并将该临时文件 传输至远程服务器的对应 执行用户 临时目录下 <code>$HOME/.ansible/tmp/ansible-tmp-2123/xxx.py</code> 文件.</p></li><li><p>对临时 <code>py</code> 文件授权 ( chmod u+x xx.py ).</p></li><li><p>执行 <code>py</code> 文件,并返回执行结果.</p></li><li><p>删除临时的 <code>py</code> 文件, sleep 0 退出.</p></li></ol><hr><ul><li><p>执行状态</p><ul><li><p>绿色: 执行操作成功并且不需要做更改的操作.</p></li><li><p>黄色: 执行操作成功, 并且对目标主机进行了变更操作. 如 更改文件内容, 重启服务, 删除文件等.</p></li><li><p>红色: 执行操作失败.</p></li></ul></li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2020-08-10</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/ansible-playbook/index.md target=_blank>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=https://jicki.cn/ansible-playbook/ data-title="ansible playbook 从入门到放弃" data-via=jicki234 data-hashtags=linux,ansible><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://jicki.cn/ansible-playbook/ data-hashtag=linux><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="分享到 WhatsApp" data-sharer=whatsapp data-url=https://jicki.cn/ansible-playbook/ data-title="ansible playbook 从入门到放弃" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href=javascript:void(0); title="分享到 Line" data-sharer=line data-url=https://jicki.cn/ansible-playbook/ data-title="ansible playbook 从入门到放弃"><i data-svg-src=/lib/simple-icons/icons/line.min.svg></i></a><a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://jicki.cn/ansible-playbook/ data-title="ansible playbook 从入门到放弃"><i class="fab fa-weibo fa-fw"></i></a><a href=javascript:void(0); title="分享到 Myspace" data-sharer=myspace data-url=https://jicki.cn/ansible-playbook/ data-title="ansible playbook 从入门到放弃" data-description="ansible playbook 从入门到放弃"><i data-svg-src=/lib/simple-icons/icons/myspace.min.svg></i></a><a href=javascript:void(0); title="分享到 Blogger" data-sharer=blogger data-url=https://jicki.cn/ansible-playbook/ data-title="ansible playbook 从入门到放弃" data-description="ansible playbook 从入门到放弃"><i class="fab fa-blogger fa-fw"></i></a><a href=javascript:void(0); title="分享到 Evernote" data-sharer=evernote data-url=https://jicki.cn/ansible-playbook/ data-title="ansible playbook 从入门到放弃"><i class="fab fa-evernote fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/linux/>linux</a>,&nbsp;<a href=/tags/ansible/>ansible</a></section><section><span><a href=javascript:void(0); onclick=window.history.back();>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/gitops-kubernetes/ class=prev rel=prev title="GitOps 实现云原生的持续交付"><i class="fas fa-angle-left fa-fw"></i>GitOps 实现云原生的持续交付</a>
<a href=/golang-study-web-notes/ class=next rel=next title="Go Web编程">Go Web编程<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=valine class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://valine.js.org/>Valine</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>由 <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.73.0">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i>LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2020</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://jicki.cn target=_blank>小炒肉</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span><span class=icp-splitter>&nbsp;|&nbsp;</span><br class=icp-br><span class=icp>粤ICP备20055633号</span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw"></i></a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=/lib/valine/valine.min.css><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/katex/copy-tex.min.css><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script type=text/javascript src=/lib/valine/Valine.min.js></script><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lunr/lunr.stemmer.support.min.js></script><script type=text/javascript src=/lib/lunr/lunr.zh.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/auto-render.min.js></script><script type=text/javascript src=/lib/katex/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/mhchem.min.js></script><script type=text/javascript src=/lib/cookieconsent/cookieconsent.min.js></script><script type=text/javascript>window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":50},"comment":{"valine":{"appId":"1LTTCvDe4Nt8XSdFzejtUsVF-gzGzoHsz","appKey":"cvpPM7sbgOw0pTXbh6YVKrjc","avatar":"mp","el":"#valine","emojiCDN":"https://cdn.jsdelivr.net/npm/emoji-datasource-google@5.0.1/img/google/64/","emojiMaps":{"100":"1f4af.png","alien":"1f47d.png","anger":"1f4a2.png","angry":"1f620.png","anguished":"1f627.png","astonished":"1f632.png","black_heart":"1f5a4.png","blue_heart":"1f499.png","blush":"1f60a.png","bomb":"1f4a3.png","boom":"1f4a5.png","broken_heart":"1f494.png","brown_heart":"1f90e.png","clown_face":"1f921.png","cold_face":"1f976.png","cold_sweat":"1f630.png","confounded":"1f616.png","confused":"1f615.png","cry":"1f622.png","crying_cat_face":"1f63f.png","cupid":"1f498.png","dash":"1f4a8.png","disappointed":"1f61e.png","disappointed_relieved":"1f625.png","dizzy":"1f4ab.png","dizzy_face":"1f635.png","drooling_face":"1f924.png","exploding_head":"1f92f.png","expressionless":"1f611.png","face_vomiting":"1f92e.png","face_with_cowboy_hat":"1f920.png","face_with_hand_over_mouth":"1f92d.png","face_with_head_bandage":"1f915.png","face_with_monocle":"1f9d0.png","face_with_raised_eyebrow":"1f928.png","face_with_rolling_eyes":"1f644.png","face_with_symbols_on_mouth":"1f92c.png","face_with_thermometer":"1f912.png","fearful":"1f628.png","flushed":"1f633.png","frowning":"1f626.png","ghost":"1f47b.png","gift_heart":"1f49d.png","green_heart":"1f49a.png","grimacing":"1f62c.png","grin":"1f601.png","grinning":"1f600.png","hankey":"1f4a9.png","hear_no_evil":"1f649.png","heart":"2764-fe0f.png","heart_decoration":"1f49f.png","heart_eyes":"1f60d.png","heart_eyes_cat":"1f63b.png","heartbeat":"1f493.png","heartpulse":"1f497.png","heavy_heart_exclamation_mark_ornament":"2763-fe0f.png","hole":"1f573-fe0f.png","hot_face":"1f975.png","hugging_face":"1f917.png","hushed":"1f62f.png","imp":"1f47f.png","innocent":"1f607.png","japanese_goblin":"1f47a.png","japanese_ogre":"1f479.png","joy":"1f602.png","joy_cat":"1f639.png","kiss":"1f48b.png","kissing":"1f617.png","kissing_cat":"1f63d.png","kissing_closed_eyes":"1f61a.png","kissing_heart":"1f618.png","kissing_smiling_eyes":"1f619.png","laughing":"1f606.png","left_speech_bubble":"1f5e8-fe0f.png","love_letter":"1f48c.png","lying_face":"1f925.png","mask":"1f637.png","money_mouth_face":"1f911.png","nauseated_face":"1f922.png","nerd_face":"1f913.png","neutral_face":"1f610.png","no_mouth":"1f636.png","open_mouth":"1f62e.png","orange_heart":"1f9e1.png","partying_face":"1f973.png","pensive":"1f614.png","persevere":"1f623.png","pleading_face":"1f97a.png","pouting_cat":"1f63e.png","purple_heart":"1f49c.png","rage":"1f621.png","relaxed":"263a-fe0f.png","relieved":"1f60c.png","revolving_hearts":"1f49e.png","right_anger_bubble":"1f5ef-fe0f.png","robot_face":"1f916.png","rolling_on_the_floor_laughing":"1f923.png","scream":"1f631.png","scream_cat":"1f640.png","see_no_evil":"1f648.png","shushing_face":"1f92b.png","skull":"1f480.png","skull_and_crossbones":"2620-fe0f.png","sleeping":"1f634.png","sleepy":"1f62a.png","slightly_frowning_face":"1f641.png","slightly_smiling_face":"1f642.png","smile":"1f604.png","smile_cat":"1f638.png","smiley":"1f603.png","smiley_cat":"1f63a.png","smiling_face_with_3_hearts":"1f970.png","smiling_imp":"1f608.png","smirk":"1f60f.png","smirk_cat":"1f63c.png","sneezing_face":"1f927.png","sob":"1f62d.png","space_invader":"1f47e.png","sparkling_heart":"1f496.png","speak_no_evil":"1f64a.png","speech_balloon":"1f4ac.png","star-struck":"1f929.png","stuck_out_tongue":"1f61b.png","stuck_out_tongue_closed_eyes":"1f61d.png","stuck_out_tongue_winking_eye":"1f61c.png","sunglasses":"1f60e.png","sweat":"1f613.png","sweat_drops":"1f4a6.png","sweat_smile":"1f605.png","thinking_face":"1f914.png","thought_balloon":"1f4ad.png","tired_face":"1f62b.png","triumph":"1f624.png","two_hearts":"1f495.png","unamused":"1f612.png","upside_down_face":"1f643.png","weary":"1f629.png","white_frowning_face":"2639-fe0f.png","white_heart":"1f90d.png","wink":"1f609.png","woozy_face":"1f974.png","worried":"1f61f.png","yawning_face":"1f971.png","yellow_heart":"1f49b.png","yum":"1f60b.png","zany_face":"1f92a.png","zipper_mouth_face":"1f910.png","zzz":"1f4a4.png"},"enableQQ":false,"highlight":true,"lang":"zh-cn","pageSize":10,"placeholder":"你的评论 ...","recordIP":true,"visitor":true}},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"lunr"}};</script><script type=text/javascript src=/js/theme.min.js></script></body></html>