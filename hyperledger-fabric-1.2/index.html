<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>hyperledger-fabric v 1.2 多机 多节点 - 小炒肉</title><meta name=Description content="hyperledger-fabric v 1.2 多机多节点"><meta property="og:title" content="hyperledger-fabric v 1.2 多机 多节点"><meta property="og:description" content="hyperledger-fabric v 1.2 多机多节点"><meta property="og:type" content="article"><meta property="og:url" content="https://jicki.cn/hyperledger-fabric-1.2/"><meta property="og:image" content="https://jicki.cn/logo.png"><meta property="article:published_time" content="2018-08-07T00:00:00+00:00"><meta property="article:modified_time" content="2018-08-07T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://jicki.cn/logo.png"><meta name=twitter:title content="hyperledger-fabric v 1.2 多机 多节点"><meta name=twitter:description content="hyperledger-fabric v 1.2 多机多节点"><meta name=application-name content="小炒肉"><meta name=apple-mobile-web-app-title content="小炒肉"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=/images/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://jicki.cn/hyperledger-fabric-1.2/><link rel=prev href=https://jicki.cn/kubernetes-1.11.0/><link rel=next href=https://jicki.cn/kubernetes-1.11.2/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"hyperledger-fabric v 1.2 多机 多节点","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/jicki.cn\/hyperledger-fabric-1.2\/"},"genre":"posts","wordcount":12761,"url":"https:\/\/jicki.cn\/hyperledger-fabric-1.2\/","datePublished":"2018-08-07T00:00:00+00:00","dateModified":"2018-08-07T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"小炒肉"},"description":"hyperledger-fabric v 1.2 多机多节点"}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':('auto'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'auto'==='dark'))&&document.body.setAttribute('theme','dark');</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=小炒肉>小炒肉</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>文章 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><a class=menu-item href=/about/>关于 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw"></i></a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw"></i></a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span></span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=小炒肉>小炒肉</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw"></i></a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw"></i></a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts/>文章</a><a class=menu-item href=/tags/>标签</a><a class=menu-item href=/categories/>分类</a><a class=menu-item href=/about/>关于</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">hyperledger-fabric v 1.2 多机 多节点</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://jicki.cn title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw"></i>小炒肉</a></span>&nbsp;<span class=post-category>收录于 <a href=/categories/fabric/><i class="far fa-folder fa-fw"></i>fabric</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2018-08-07>2018-08-07</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 12761 字&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 26 分钟&nbsp;<span id=/hyperledger-fabric-1.2/ class=leancloud_visitors data-flag-title="hyperledger-fabric v 1.2 多机 多节点">
<i class="far fa-eye fa-fw"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;次阅读
</span>&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#环境规划>环境规划</a></li><li><a href=#官方地址>官方地址</a></li><li><a href=#环境准备>环境准备</a></li><li><a href=#hyperledger-fabric-源码>Hyperledger Fabric 源码</a></li><li><a href=#生成-hyperledger-fabric-证书>生成 Hyperledger Fabric 证书</a></li><li><a href=#生成-hyperledger-fabric-创世区块>生成 Hyperledger Fabric 创世区块</a></li><li><a href=#配置-zookeeper-kafka-集群>配置 Zookeeper Kafka 集群</a><ul><li><a href=#第一个节点-19216810067>第一个节点 (192.168.100.67)</a></li><li><a href=#第二个节点-19216810015>第二个节点 (192.168.100.15)</a></li><li><a href=#第三个节点-19216810091>第三个节点 (192.168.100.91)</a></li></ul></li><li><a href=#配置-hyperledger-fabric-orderer>配置 Hyperledger Fabric Orderer</a><ul><li><a href=#第一个节点-19216810067-1>第一个节点 (192.168.100.67)</a></li><li><a href=#第二个节点-19216810015-1>第二个节点 (192.168.100.15)</a></li><li><a href=#第三个节点-19216810091-1>第三个节点 (192.168.100.91)</a></li><li><a href=#启动服务>启动服务</a></li></ul></li><li><a href=#配置-hyperledger-fabric-peer>配置 Hyperledger Fabric peer</a><ul><li><a href=#第二个节点-19216810015-2>第二个节点 (192.168.100.15)</a></li><li><a href=#第三个节点-19216810091-2>第三个节点 (192.168.100.91)</a></li><li><a href=#启动服务-1>启动服务</a></li></ul></li><li><a href=#配置-hyperledger-fabric-cli-客户端>配置 Hyperledger Fabric cli 客户端</a><ul><li><a href=#启动服务-2>启动服务</a></li></ul></li><li><a href=#hyperledger-fabric-创建-channel>Hyperledger Fabric 创建 Channel</a></li><li><a href=#hyperledger-fabric-加入-channel>Hyperledger Fabric 加入 Channel</a></li><li><a href=#hyperledger-fabric-锚节点>Hyperledger Fabric 锚节点</a></li><li><a href=#hyperledger-fabric-实例化测试>Hyperledger Fabric 实例化测试</a><ul><li><a href=#安装智能合约>安装智能合约</a></li><li><a href=#实例化-chaincode>实例化 Chaincode</a></li><li><a href=#操作智能合约>操作智能合约</a></li></ul></li><li><a href=#hyperledger-fabric-操作命令>Hyperledger Fabric 操作命令</a><ul><li><a href=#peer-命令>peer 命令</a></li></ul></li></ul></nav></div></div><div class=content id=content><blockquote><p>fabric v1.2 , 多机，多节点，多 Orderer ，生产环境配置。</p></blockquote><h1 id=部署-hyperledger-fabric-v12>部署 hyperledger-fabric v1.2</h1><h2 id=环境规划>环境规划</h2><blockquote><p>相关hostname 必须配置 dns</p><p>关于 orderer 集群</p><p>当orderer 向peer节点提交Transaction的时候，peer节点会得到或返回一个读写集结果，该结果会发送给orderer节点进行共识和排序，此时如果orderer节点突然down掉，就会使请求服务失效而引发的数据丢失等问题，且目前的sdk对orderer发送的Transaction的回调会占用极长的时间，当大批量数据导入的时候该回调可认为不可用。</p></blockquote><table><thead><tr><th>节点标识</th><th>hostname</th><th>IP</th><th>开放端口</th><th>系统</th><th></th><th></th></tr></thead><tbody><tr><td>orderer0节点</td><td>orderer0.jicki.cn</td><td>192.168.100.67</td><td>7050</td><td>CentOS 7 x64</td><td></td><td></td></tr><tr><td>orderer1节点</td><td>orderer1.jicki.cn</td><td>192.168.100.15</td><td>7050</td><td>CentOS 7 x64</td><td></td><td></td></tr><tr><td>orderer2节点</td><td>orderer2.jicki.cn</td><td>192.168.100.91</td><td>7050</td><td>CentOS 7 x64</td><td></td><td></td></tr><tr><td>peer0节点</td><td>peer0.org1.jicki.cn</td><td>192.168.100.15</td><td>7051, 7052, 7053</td><td>CentOS 7 x64</td><td></td><td></td></tr><tr><td>peer0节点</td><td>peer0.org2.jicki.cn</td><td>192.168.100.91</td><td>7051, 7052, 7053</td><td>CentOS 7 x64</td><td></td><td></td></tr><tr><td>zk0节点</td><td>zookeeper0</td><td>192.168.100.67</td><td>2181</td><td>CentOS 7 x64</td><td></td><td></td></tr><tr><td>zk1节点</td><td>zookeeper1</td><td>192.168.100.15</td><td>2181</td><td>CentOS 7 x64</td><td></td><td></td></tr><tr><td>zk2节点</td><td>zookeeper2</td><td>192.168.100.91</td><td>2181</td><td>CentOS 7 x64</td><td></td><td></td></tr><tr><td>kafka0节点</td><td>kafka0</td><td>192.168.100.67</td><td>9092</td><td>CentOS 7 x64</td><td></td><td></td></tr><tr><td>kafka1节点</td><td>kafka1</td><td>192.168.100.15</td><td>9092</td><td>CentOS 7 x64</td><td></td><td></td></tr><tr><td>kafka2节点</td><td>kafka2</td><td>192.168.100.91</td><td>9092</td><td>CentOS 7 x64</td><td></td><td></td></tr></tbody></table><blockquote><p>所有节点 docker 互为单机，不做网络集群，连接使用 hostname or IP</p><p>所有需要配置 hosts 域名</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 所有节点均需要配置

vi /etc/hosts

# fabric hostname

192.168.100.67 orderer0.jicki.cn
192.168.100.15 orderer1.jicki.cn
192.168.100.91 orderer2.jicki.cn
192.168.100.15 peer0.org1.jicki.cn
192.168.100.91 peer0.org2.jicki.cn
192.168.100.67 zookeeper0
192.168.100.15 zookeeper1
192.168.100.91 zookeeper2
192.168.100.67 kafka0
192.168.100.15 kafka1
192.168.100.91 kafka2

# fabric hostname


</code></pre></td></tr></table></div></div><h2 id=官方地址>官方地址</h2><blockquote><p>文档以官方文档为主 <a href=http://hyperledger-fabric.readthedocs.io/en/release-1.2/prereqs.html>http://hyperledger-fabric.readthedocs.io/en/release-1.2/prereqs.html</a></p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 官网 github
https://github.com/hyperledger/fabric
</code></pre></td></tr></table></div></div><h2 id=环境准备>环境准备</h2><blockquote><p>所有机器 安装 Docker (用于 fabric 服务启动)</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 导入 yum 源

# 安装 yum-config-manager

yum -y install yum-utils

# 导入
yum-config-manager \
    --add-repo \
    https://download.docker.com/linux/centos/docker-ce.repo
    
    
    
# 安装 docker

yum -y install docker-ce
    
</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>
# 启动 docker 

systemctl daemon-reload
systemctl start docker
systemctl enable docker

</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 查看 docker 版本

docker version
Client:
 Version:           18.06.0-ce
 API version:       1.38
 Go version:        go1.10.3
 Git commit:        0ffa825
 Built:             Wed Jul 18 19:08:18 2018
 OS/Arch:           linux/amd64
 Experimental:      false

Server:
 Engine:
  Version:          18.06.0-ce
  API version:      1.38 (minimum version 1.12)
  Go version:       go1.10.3
  Git commit:       0ffa825
  Built:            Wed Jul 18 19:10:42 2018
  OS/Arch:          linux/amd64
  Experimental:     false
</code></pre></td></tr></table></div></div><ul><li>安装 Docker-compose (用于 docker 容器服务统一管理 编排)</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 安装 pip

curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py

python get-pip.py

</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 安装 docker-compose

pip install docker-compose --ignore-installed requests

</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>docker-compose version
docker-compose version 1.22.0, build f46880f
docker-py version: 3.4.1
CPython version: 2.7.5
OpenSSL version: OpenSSL 1.0.1e-fips 11 Feb 2013
</code></pre></td></tr></table></div></div><ul><li>Golang (用于 fabric cli 服务的调用， ca 服务证书生成 )</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>mkdir -p /opt/golang
mkdir -p /opt/gopath

# 国外地址
wget https://storage.googleapis.com/golang/go1.10.linux-amd64.tar.gz

# 国内地址
wget https://studygolang.com/dl/golang/go1.10.linux-amd64.tar.gz


# 解压
tar zxvf go1.10.linux-amd64.tar.gz

# 配置环境变量

vi /etc/profile

添加如下

# golang env
export PATH=$PATH:/opt/golang/go/bin
export GOPATH=/opt/gopath

# 生效配置

source /etc/profile


# 查看配置

go version
go version go1.10 linux/amd64

</code></pre></td></tr></table></div></div><h2 id=hyperledger-fabric-源码>Hyperledger Fabric 源码</h2><blockquote><p>fabric 源码用于 cli 智能合约安装时的依赖, 这里只用于第一个节点</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 下载 Fabric 源码, 源码中 import 的路径为github.com/hyperledger/fabric ,所以我们要按照这个路径

mkdir -p /opt/gopath/src/github.com/hyperledger

cd /opt/gopath/src/github.com/hyperledger

git clone https://github.com/hyperledger/fabric

mkdir -p /opt/gopath/src

cp -r github.com /opt/gopath/src


# 文件如下:

[root@localhost fabric]# ls -lt
总用量 580
drwxr-xr-x  7 root root    138 6月   5 09:29 vendor
-rw-r--r--  1 root root    301 6月   5 09:29 tox.ini
drwxr-xr-x  2 root root     56 6月   5 09:29 unit-test
drwxr-xr-x  7 root root    134 6月   5 09:29 test
drwxr-xr-x  2 root root   4096 6月   5 09:29 scripts
-rw-r--r--  1 root root    316 6月   5 09:29 settings.gradle
drwxr-xr-x  3 root root     91 6月   5 09:29 sampleconfig
drwxr-xr-x  2 root root   4096 6月   5 09:29 release_notes
drwxr-xr-x 11 root root   4096 6月   5 09:29 protos
drwxr-xr-x  3 root root     30 6月   5 09:29 release
drwxr-xr-x  9 root root    154 6月   5 09:29 peer
drwxr-xr-x  3 root root     23 6月   5 09:29 proposals
drwxr-xr-x  6 root root    126 6月   5 09:29 orderer
drwxr-xr-x  6 root root   4096 6月   5 09:29 msp
drwxr-xr-x  9 root root    130 6月   5 09:29 images
drwxr-xr-x  2 root root     29 6月   5 09:29 gotools
drwxr-xr-x  2 root root   4096 6月   5 09:29 idemix
drwxr-xr-x 15 root root   4096 6月   5 09:29 gossip
drwxr-xr-x 10 root root   4096 6月   5 09:29 examples
drwxr-xr-x  4 root root     48 6月   5 09:29 events
drwxr-xr-x  4 root root    137 6月   5 09:29 docs
drwxr-xr-x  4 root root   4096 6月   5 09:29 devenv
-rw-r--r--  1 root root   3356 6月   5 09:29 docker-env.mk
drwxr-xr-x 20 root root   4096 6月   5 09:29 core
drwxr-xr-x 23 root root   4096 6月   5 09:29 common
drwxr-xr-x 10 root root   4096 6月   5 09:29 bddtests
-rw-r--r--  1 root root     13 6月   5 09:29 ci.properties
drwxr-xr-x  8 root root   4096 6月   5 09:29 bccsp
-rw-r--r--  1 root root  11358 6月   5 09:29 LICENSE
-rwxr-xr-x  1 root root  17068 6月   5 09:29 Makefile
-rw-r--r--  1 root root   5678 6月   5 09:29 README.md
-rw-r--r--  1 root root 475471 6月   5 09:29 CHANGELOG.md
-rw-r--r--  1 root root    597 6月   5 09:29 CODE_OF_CONDUCT.md
-rw-r--r--  1 root root    664 6月   5 09:29 CONTRIBUTING.md


</code></pre></td></tr></table></div></div><h2 id=生成-hyperledger-fabric-证书>生成 Hyperledger Fabric 证书</h2><blockquote><p>证书生成只需要生成一次，这里只在第一个节点配置</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 下载官方证书生成软件(均为二进制文件)
# 官方离线下载地址为 https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/


# 选择相应版本 CentOS 选择 linux-amd64-1.2.0  Mac 选择 darwin-amd64-1.2.0


# 下载地址为: https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/linux-amd64-1.2.0/hyperledger-fabric-linux-amd64-1.2.0.tar.gz



mkdir /opt/jicki/

cd /opt/jicki

wget https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/linux-amd64-1.2.0/hyperledger-fabric-linux-amd64-1.2.0.tar.gz

tar zxvf hyperledger-fabric-linux-amd64-1.2.0.tar.gz

# 解压后是 一个 bin 与 一个 config 目录

[root@localhost jicki]# tree bin/
bin/
├── configtxgen
├── configtxlator
├── cryptogen
├── get-docker-images.sh
├── orderer
└── peer

0 directories, 6 files
 
 
# 为方便使用 我们配置一个 环境变量

vi /etc/profile


# fabric env
export PATH=$PATH:/opt/jicki/bin


# 使文件生效
source /etc/profile

</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 拷贝 configtx.yaml  与 crypto-config.yaml 。


cd /opt/jicki/

cp /opt/gopath/src/github.com/hyperledger/fabric/examples/e2e_cli/crypto-config.yaml .

cp /opt/gopath/src/github.com/hyperledger/fabric/examples/e2e_cli/configtx.yaml .

</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 这里修改相应 jicki.cn 为 jicki.cn

sed -i &#39;s/example\.com/jicki\.me/g&#39; *.yaml


# 编辑 crypto-config.yaml 增加 orderer 为三个如下:


OrdererOrgs:
  - Name: Orderer
    Domain: jicki.cn
    CA:
        Country: CN
        Province: GuangDong
        Locality: ShenZhen
    Specs:
      - Hostname: orderer0
      - Hostname: orderer1
      - Hostname: orderer2
      
PeerOrgs:
  - Name: Org1
    Domain: org1.jicki.cn
    EnableNodeOUs: true
    CA:
        Country: CN
        Province: GuangDong
        Locality: ShenZhen
    Template:
      Count: 2
    Users:
      Count: 1
  - Name: Org2
    Domain: org2.jicki.cn
    EnableNodeOUs: true
    CA:
        Country: CN
        Province: GuangDong
        Locality: ShenZhen
    Template:
      Count: 2
    Users:
      Count: 1
      
</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span><span class=lnt>216
</span><span class=lnt>217
</span><span class=lnt>218
</span><span class=lnt>219
</span><span class=lnt>220
</span><span class=lnt>221
</span><span class=lnt>222
</span><span class=lnt>223
</span><span class=lnt>224
</span><span class=lnt>225
</span><span class=lnt>226
</span><span class=lnt>227
</span><span class=lnt>228
</span><span class=lnt>229
</span><span class=lnt>230
</span><span class=lnt>231
</span><span class=lnt>232
</span><span class=lnt>233
</span><span class=lnt>234
</span><span class=lnt>235
</span><span class=lnt>236
</span><span class=lnt>237
</span><span class=lnt>238
</span><span class=lnt>239
</span><span class=lnt>240
</span><span class=lnt>241
</span><span class=lnt>242
</span><span class=lnt>243
</span><span class=lnt>244
</span><span class=lnt>245
</span><span class=lnt>246
</span><span class=lnt>247
</span><span class=lnt>248
</span><span class=lnt>249
</span><span class=lnt>250
</span><span class=lnt>251
</span><span class=lnt>252
</span><span class=lnt>253
</span><span class=lnt>254
</span><span class=lnt>255
</span><span class=lnt>256
</span><span class=lnt>257
</span><span class=lnt>258
</span><span class=lnt>259
</span><span class=lnt>260
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 然后这里使用 cryptogen 软件来生成相应的证书了

[root@localhost jicki]# cryptogen generate --config=./crypto-config.yaml
org1.jicki.cn
org2.jicki.cn

# 生成一个 crypto-config 证书目录

[root@payment jicki]# tree crypto-config
crypto-config
├── ordererOrganizations
│   └── jicki.cn
│       ├── ca
│       │   ├── ca.jicki.cn-cert.pem
│       │   └── ea7afe99d56e6c2e839113909651f8b3531a6447e4615eed208c7aa86b211ad0_sk
│       ├── msp
│       │   ├── admincerts
│       │   │   └── Admin@jicki.cn-cert.pem
│       │   ├── cacerts
│       │   │   └── ca.jicki.cn-cert.pem
│       │   └── tlscacerts
│       │       └── tlsca.jicki.cn-cert.pem
│       ├── orderers
│       │   ├── orderer0.jicki.cn
│       │   │   ├── msp
│       │   │   │   ├── admincerts
│       │   │   │   │   └── Admin@jicki.cn-cert.pem
│       │   │   │   ├── cacerts
│       │   │   │   │   └── ca.jicki.cn-cert.pem
│       │   │   │   ├── keystore
│       │   │   │   │   └── c4ff1a8f55af9e4108596a26471a2a748eeb370b00300abddac692d5c5f72f57_sk
│       │   │   │   ├── signcerts
│       │   │   │   │   └── orderer0.jicki.cn-cert.pem
│       │   │   │   └── tlscacerts
│       │   │   │       └── tlsca.jicki.cn-cert.pem
│       │   │   └── tls
│       │   │       ├── ca.crt
│       │   │       ├── server.crt
│       │   │       └── server.key
│       │   ├── orderer1.jicki.cn
│       │   │   ├── msp
│       │   │   │   ├── admincerts
│       │   │   │   │   └── Admin@jicki.cn-cert.pem
│       │   │   │   ├── cacerts
│       │   │   │   │   └── ca.jicki.cn-cert.pem
│       │   │   │   ├── keystore
│       │   │   │   │   └── f057fd116621213b9d06cf05d1b04b3b53057b4df4338ca5bb3b59e36acf074a_sk
│       │   │   │   ├── signcerts
│       │   │   │   │   └── orderer1.jicki.cn-cert.pem
│       │   │   │   └── tlscacerts
│       │   │   │       └── tlsca.jicki.cn-cert.pem
│       │   │   └── tls
│       │   │       ├── ca.crt
│       │   │       ├── server.crt
│       │   │       └── server.key
│       │   └── orderer2.jicki.cn
│       │       ├── msp
│       │       │   ├── admincerts
│       │       │   │   └── Admin@jicki.cn-cert.pem
│       │       │   ├── cacerts
│       │       │   │   └── ca.jicki.cn-cert.pem
│       │       │   ├── keystore
│       │       │   │   └── a0395ee7823af3ab3ae56fa4569051a5525324f506cd38b0d0dcaa3e484ae084_sk
│       │       │   ├── signcerts
│       │       │   │   └── orderer2.jicki.cn-cert.pem
│       │       │   └── tlscacerts
│       │       │       └── tlsca.jicki.cn-cert.pem
│       │       └── tls
│       │           ├── ca.crt
│       │           ├── server.crt
│       │           └── server.key
│       ├── tlsca
│       │   ├── 4164a39aaee758c85e9d4458bae4d51f0d01e58116003cd5782dbbaff68b1545_sk
│       │   └── tlsca.jicki.cn-cert.pem
│       └── users
│           └── Admin@jicki.cn
│               ├── msp
│               │   ├── admincerts
│               │   │   └── Admin@jicki.cn-cert.pem
│               │   ├── cacerts
│               │   │   └── ca.jicki.cn-cert.pem
│               │   ├── keystore
│               │   │   └── 30d0b23ab85ede3d4424a336d839067bf7cad70f538fcf87d2a9c5083b5482f4_sk
│               │   ├── signcerts
│               │   │   └── Admin@jicki.cn-cert.pem
│               │   └── tlscacerts
│               │       └── tlsca.jicki.cn-cert.pem
│               └── tls
│                   ├── ca.crt
│                   ├── client.crt
│                   └── client.key
└── peerOrganizations
    ├── org1.jicki.cn
    │   ├── ca
    │   │   ├── 98671ea7c42ccdeb73327d7c67f759e487497f13349b97a135392f660cf6747f_sk
    │   │   └── ca.org1.jicki.cn-cert.pem
    │   ├── msp
    │   │   ├── admincerts
    │   │   │   └── Admin@org1.jicki.cn-cert.pem
    │   │   ├── cacerts
    │   │   │   └── ca.org1.jicki.cn-cert.pem
    │   │   ├── config.yaml
    │   │   └── tlscacerts
    │   │       └── tlsca.org1.jicki.cn-cert.pem
    │   ├── peers
    │   │   ├── peer0.org1.jicki.cn
    │   │   │   ├── msp
    │   │   │   │   ├── admincerts
    │   │   │   │   │   └── Admin@org1.jicki.cn-cert.pem
    │   │   │   │   ├── cacerts
    │   │   │   │   │   └── ca.org1.jicki.cn-cert.pem
    │   │   │   │   ├── config.yaml
    │   │   │   │   ├── keystore
    │   │   │   │   │   └── c99b65a414bc877998bb52c7ba80faf7e01d6512e8e50253daccd93e273bbb24_sk
    │   │   │   │   ├── signcerts
    │   │   │   │   │   └── peer0.org1.jicki.cn-cert.pem
    │   │   │   │   └── tlscacerts
    │   │   │   │       └── tlsca.org1.jicki.cn-cert.pem
    │   │   │   └── tls
    │   │   │       ├── ca.crt
    │   │   │       ├── server.crt
    │   │   │       └── server.key
    │   │   └── peer1.org1.jicki.cn
    │   │       ├── msp
    │   │       │   ├── admincerts
    │   │       │   │   └── Admin@org1.jicki.cn-cert.pem
    │   │       │   ├── cacerts
    │   │       │   │   └── ca.org1.jicki.cn-cert.pem
    │   │       │   ├── config.yaml
    │   │       │   ├── keystore
    │   │       │   │   └── f1a8262cd8c78642d0aa50eb9ac2bae98949ce937063fb8e0d0c03fb7b16e4ce_sk
    │   │       │   ├── signcerts
    │   │       │   │   └── peer1.org1.jicki.cn-cert.pem
    │   │       │   └── tlscacerts
    │   │       │       └── tlsca.org1.jicki.cn-cert.pem
    │   │       └── tls
    │   │           ├── ca.crt
    │   │           ├── server.crt
    │   │           └── server.key
    │   ├── tlsca
    │   │   ├── c4e8130e739a69e6f9628e1e98fa54326ddfdcc93ef8568ffb72ba521069f3d1_sk
    │   │   └── tlsca.org1.jicki.cn-cert.pem
    │   └── users
    │       ├── Admin@org1.jicki.cn
    │       │   ├── msp
    │       │   │   ├── admincerts
    │       │   │   │   └── Admin@org1.jicki.cn-cert.pem
    │       │   │   ├── cacerts
    │       │   │   │   └── ca.org1.jicki.cn-cert.pem
    │       │   │   ├── keystore
    │       │   │   │   └── c8edb858abc7a4589458419d9ca74125830115e1e3544cc85c7a4a91f8b84b52_sk
    │       │   │   ├── signcerts
    │       │   │   │   └── Admin@org1.jicki.cn-cert.pem
    │       │   │   └── tlscacerts
    │       │   │       └── tlsca.org1.jicki.cn-cert.pem
    │       │   └── tls
    │       │       ├── ca.crt
    │       │       ├── client.crt
    │       │       └── client.key
    │       └── User1@org1.jicki.cn
    │           ├── msp
    │           │   ├── admincerts
    │           │   │   └── User1@org1.jicki.cn-cert.pem
    │           │   ├── cacerts
    │           │   │   └── ca.org1.jicki.cn-cert.pem
    │           │   ├── keystore
    │           │   │   └── c720e53e25331b60bd8b33f2e19642e1ebef092afcc5f4c07f6efab91eceb298_sk
    │           │   ├── signcerts
    │           │   │   └── User1@org1.jicki.cn-cert.pem
    │           │   └── tlscacerts
    │           │       └── tlsca.org1.jicki.cn-cert.pem
    │           └── tls
    │               ├── ca.crt
    │               ├── client.crt
    │               └── client.key
    └── org2.jicki.cn
        ├── ca
        │   ├── 5e398a55ab9e021cc89f60dfc16ae21def5b35495f0621d8aa55a2463ba051f6_sk
        │   └── ca.org2.jicki.cn-cert.pem
        ├── msp
        │   ├── admincerts
        │   │   └── Admin@org2.jicki.cn-cert.pem
        │   ├── cacerts
        │   │   └── ca.org2.jicki.cn-cert.pem
        │   ├── config.yaml
        │   └── tlscacerts
        │       └── tlsca.org2.jicki.cn-cert.pem
        ├── peers
        │   ├── peer0.org2.jicki.cn
        │   │   ├── msp
        │   │   │   ├── admincerts
        │   │   │   │   └── Admin@org2.jicki.cn-cert.pem
        │   │   │   ├── cacerts
        │   │   │   │   └── ca.org2.jicki.cn-cert.pem
        │   │   │   ├── config.yaml
        │   │   │   ├── keystore
        │   │   │   │   └── a4eb0cf3769173e73cfcaa74ec938ef2def877b0ae0efe4e95be4a7588621da0_sk
        │   │   │   ├── signcerts
        │   │   │   │   └── peer0.org2.jicki.cn-cert.pem
        │   │   │   └── tlscacerts
        │   │   │       └── tlsca.org2.jicki.cn-cert.pem
        │   │   └── tls
        │   │       ├── ca.crt
        │   │       ├── server.crt
        │   │       └── server.key
        │   └── peer1.org2.jicki.cn
        │       ├── msp
        │       │   ├── admincerts
        │       │   │   └── Admin@org2.jicki.cn-cert.pem
        │       │   ├── cacerts
        │       │   │   └── ca.org2.jicki.cn-cert.pem
        │       │   ├── config.yaml
        │       │   ├── keystore
        │       │   │   └── 26e3d15b68a9d2b022e6560607b3556e0150df3526826ff4a81c585714d5d41c_sk
        │       │   ├── signcerts
        │       │   │   └── peer1.org2.jicki.cn-cert.pem
        │       │   └── tlscacerts
        │       │       └── tlsca.org2.jicki.cn-cert.pem
        │       └── tls
        │           ├── ca.crt
        │           ├── server.crt
        │           └── server.key
        ├── tlsca
        │   ├── 0979917773701392b0e7f1924ae711cedfae0dfbb4d82bd5a90c18207855fe8e_sk
        │   └── tlsca.org2.jicki.cn-cert.pem
        └── users
            ├── Admin@org2.jicki.cn
            │   ├── msp
            │   │   ├── admincerts
            │   │   │   └── Admin@org2.jicki.cn-cert.pem
            │   │   ├── cacerts
            │   │   │   └── ca.org2.jicki.cn-cert.pem
            │   │   ├── keystore
            │   │   │   └── ba8e549c298b47d1889d51d75e3a01724b8d2b068da369c7319f2cd586c49e70_sk
            │   │   ├── signcerts
            │   │   │   └── Admin@org2.jicki.cn-cert.pem
            │   │   └── tlscacerts
            │   │       └── tlsca.org2.jicki.cn-cert.pem
            │   └── tls
            │       ├── ca.crt
            │       ├── client.crt
            │       └── client.key
            └── User1@org2.jicki.cn
                ├── msp
                │   ├── admincerts
                │   │   └── User1@org2.jicki.cn-cert.pem
                │   ├── cacerts
                │   │   └── ca.org2.jicki.cn-cert.pem
                │   ├── keystore
                │   │   └── e183353072b166455f40b2b65ec168f52518101ee7097345cd8ff8864a71698e_sk
                │   ├── signcerts
                │   │   └── User1@org2.jicki.cn-cert.pem
                │   └── tlscacerts
                │       └── tlsca.org2.jicki.cn-cert.pem
                └── tls
                    ├── ca.crt
                    ├── client.crt
                    └── client.key

125 directories, 123 files
</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 这里为了方便， 将整个证书目录拷贝到其他节点里去 
# 一般来说只需要拷贝对应的

scp -r crypto-config 192.168.100.15:/opt/jicki

scp -r crypto-config 192.168.100.91:/opt/jicki



</code></pre></td></tr></table></div></div><h2 id=生成-hyperledger-fabric-创世区块>生成 Hyperledger Fabric 创世区块</h2><blockquote><p>只在第一个节点配置</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 这里使用 configtxgen 来创建 创世区块


# 首先需要创建一个文件夹
mkdir -p /opt/jicki/channel-artifacts


# 修改 configtx.yaml 文件增加 orderer 多节点 以及 peer 多节点, 删除了 &amp;Org3 节点

# 完整 configtx.yaml 如下: 
# configtx.yaml 文件格式 请千万注意 空格 与 tab 键 里的缩进，否则会报错。

Organizations:

    - &amp;OrdererOrg
        Name: OrdererOrg
        ID: OrdererMSP
        MSPDir: crypto-config/ordererOrganizations/jicki.cn/msp
        Policies:
            Readers:
                Type: Signature
                Rule: &#34;OR(&#39;OrdererMSP.member&#39;)&#34;
            Writers:
                Type: Signature
                Rule: &#34;OR(&#39;OrdererMSP.member&#39;)&#34;
            Admins:
                Type: Signature
                Rule: &#34;OR(&#39;OrdererMSP.admin&#39;)&#34;

    - &amp;Org1
        Name: Org1MSP
        ID: Org1MSP
        MSPDir: crypto-config/peerOrganizations/org1.jicki.cn/msp
        AnchorPeers:
            - Host: peer0.org1.jicki.cn
              Port: 7051
        Policies:
            Readers:
                Type: Signature
                Rule: &#34;OR(&#39;Org1MSP.admin&#39;, &#39;Org1MSP.peer&#39;, &#39;Org1MSP.client&#39;)&#34;
            Writers:
                Type: Signature
                Rule: &#34;OR(&#39;Org1MSP.admin&#39;, &#39;Org1MSP.client&#39;)&#34;
            Admins:
                Type: Signature
                Rule: &#34;OR(&#39;Org1MSP.admin&#39;)&#34;

    - &amp;Org2
        Name: Org2MSP
        ID: Org2MSP
        MSPDir: crypto-config/peerOrganizations/org2.jicki.cn/msp
        AnchorPeers:
            - Host: peer0.org2.jicki.cn
              Port: 7051
        Policies:
            Readers:
                Type: Signature
                Rule: &#34;OR(&#39;Org2MSP.admin&#39;, &#39;Org2MSP.peer&#39;, &#39;Org2MSP.client&#39;)&#34;
            Writers:
                Type: Signature
                Rule: &#34;OR(&#39;Org2MSP.admin&#39;, &#39;Org2MSP.client&#39;)&#34;
            Admins:
                Type: Signature
                Rule: &#34;OR(&#39;Org2MSP.admin&#39;)&#34;

Capabilities:
    Global: &amp;ChannelCapabilities
        V1_1: true

    Orderer: &amp;OrdererCapabilities
        V1_1: true

    Application: &amp;ApplicationCapabilities
        V1_2: true

Application: &amp;ApplicationDefaults

    Organizations:

    Policies:
        Readers:
            Type: ImplicitMeta
            Rule: &#34;ANY Readers&#34;
        Writers:
            Type: ImplicitMeta
            Rule: &#34;ANY Writers&#34;
        Admins:
            Type: ImplicitMeta
            Rule: &#34;MAJORITY Admins&#34;
    Capabilities:
        &lt;&lt;: *ApplicationCapabilities

Orderer: &amp;OrdererDefaults
    OrdererType: kafka
    Addresses:
        - orderer0.jicki.cn:7050
        - orderer1.jicki.cn:7050
        - orderer2.jicki.cn:7050

    BatchTimeout: 2s
    BatchSize:
        MaxMessageCount: 10
        # 设置最大的区块大小。每个区块最大有Orderer.AbsoluteMaxBytes个字节
        # 假定这里设置的值为 99MB，记住这个值，这会影响怎样配置Kafka代理。
        AbsoluteMaxBytes: 99 MB
        # 设置每个区块建议的大小。Kafka对于相对小的消息提供更高的吞吐量。
        # 区块大小最好不要超过1MB。
        PreferredMaxBytes: 512 KB
    Kafka:
        Brokers:
        # 这里如果非容器内建议使用 [ip:port]配置kafka 集群。
        # 如下为 单机版本集群内的配置。
        # kafka 集群最少为3节点, 建议配置4个以上。
            - kafka0:9092
            - kafka1:9092
            - kafka2:9092
    Organizations:
    
    Policies:
        Readers:
            Type: ImplicitMeta
            Rule: &#34;ANY Readers&#34;
        Writers:
            Type: ImplicitMeta
            Rule: &#34;ANY Writers&#34;
        Admins:
            Type: ImplicitMeta
            Rule: &#34;MAJORITY Admins&#34;
        BlockValidation:
            Type: ImplicitMeta
            Rule: &#34;ANY Writers&#34;
    Capabilities:
        &lt;&lt;: *OrdererCapabilities

Channel: &amp;ChannelDefaults

    Policies:
        Readers:
            Type: ImplicitMeta
            Rule: &#34;ANY Readers&#34;
        Writers:
            Type: ImplicitMeta
            Rule: &#34;ANY Writers&#34;
        Admins:
            Type: ImplicitMeta
            Rule: &#34;MAJORITY Admins&#34;

    Capabilities:
        &lt;&lt;: *ChannelCapabilities

Profiles:

    TwoOrgsOrdererGenesis:
        &lt;&lt;: *ChannelDefaults
        Orderer:
            &lt;&lt;: *OrdererDefaults
            Organizations:
                - *OrdererOrg
        Consortiums:
            SampleConsortium:
                Organizations:
                    - *Org1
                    - *Org2
    TwoOrgsChannel:
        Consortium: SampleConsortium
        Application:
            &lt;&lt;: *ApplicationDefaults
            Organizations:
                - *Org1
                - *Org2

</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 创建 创世区块  TwoOrgsOrdererGenesis 名称为 configtx.yaml 中 Profiles 字段下的

[root@localhost jicki]# configtxgen -profile TwoOrgsOrdererGenesis -outputBlock ./channel-artifacts/genesis.block


2018-07-24 14:17:28.681 CST [common/tools/configtxgen] main -&gt; WARN 001 Omitting the channel ID for configtxgen is deprecated.  Explicitly passing the channel ID will be required in the future, defaulting to &#39;testchainid&#39;.
2018-07-24 14:17:28.681 CST [common/tools/configtxgen] main -&gt; INFO 002 Loading configuration
2018-07-24 14:17:28.726 CST [msp] getMspConfig -&gt; INFO 003 Loading NodeOUs
2018-07-24 14:17:28.727 CST [msp] getMspConfig -&gt; INFO 004 Loading NodeOUs
2018-07-24 14:17:28.727 CST [common/tools/configtxgen] doOutputBlock -&gt; INFO 005 Generating genesis block
2018-07-24 14:17:28.728 CST [common/tools/configtxgen] doOutputBlock -&gt; INFO 006 Writing genesis block



# 创世区块 是在 orderer 服务中使用

[root@localhost jicki]# ls -lt channel-artifacts/
总用量 16
-rw-r--r-- 1 root root 12484 7月  24 14:17 genesis.block
</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 下面来生成一个 peer 服务 中使用的 tx 文件 TwoOrgsChannel 名称为 configtx.yaml 中 Profiles 字段下的，这里必须指定上面的 channelID


[root@localhost jicki]# configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./channel-artifacts/channel.tx -channelID mychannel


2018-07-24 14:18:02.261 CST [common/tools/configtxgen] main -&gt; INFO 001 Loading configuration
2018-07-24 14:18:02.306 CST [common/tools/configtxgen] doOutputChannelCreateTx -&gt; INFO 002 Generating new channel configtx
2018-07-24 14:18:02.307 CST [msp] getMspConfig -&gt; INFO 003 Loading NodeOUs
2018-07-24 14:18:02.308 CST [msp] getMspConfig -&gt; INFO 004 Loading NodeOUs
2018-07-24 14:18:02.311 CST [common/tools/configtxgen] doOutputChannelCreateTx -&gt; INFO 005 Writing new channel tx



[root@localhost jicki]# ls -lt channel-artifacts/
总用量 20
-rw-r--r-- 1 root root   346 7月  24 14:18 channel.tx
-rw-r--r-- 1 root root 12484 7月  24 14:17 genesis.block

</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 定义组织 生成锚节点更新文件


# Org1MSP

[root@localhost jicki]# configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./channel-artifacts/Org1MSPanchors.tx -channelID mychannel -asOrg Org1MSP


2018-07-24 14:18:02.261 CST [common/tools/configtxgen] main -&gt; INFO 001 Loading configuration
2018-07-24 14:18:02.306 CST [common/tools/configtxgen] doOutputChannelCreateTx -&gt; INFO 002 Generating new channel configtx
2018-07-24 14:18:02.307 CST [msp] getMspConfig -&gt; INFO 003 Loading NodeOUs
2018-07-24 14:18:02.308 CST [msp] getMspConfig -&gt; INFO 004 Loading NodeOUs
2018-07-24 14:18:02.311 CST [common/tools/configtxgen] doOutputChannelCreateTx -&gt; INFO 005 Writing new channel tx



# Org2MSP


[root@localhost jicki]# configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./channel-artifacts/Org2MSPanchors.tx -channelID mychannel -asOrg Org2MSP

2018-07-24 14:19:21.947 CST [common/tools/configtxgen] main -&gt; INFO 001 Loading configuration
2018-07-24 14:19:21.993 CST [common/tools/configtxgen] doOutputAnchorPeersUpdate -&gt; INFO 002 Generating anchor peer update
2018-07-24 14:19:21.993 CST [common/tools/configtxgen] doOutputAnchorPeersUpdate -&gt; INFO 003 Writing anchor peer update


</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 拷贝 channel-artifacts 目录到其他节点

scp -r channel-artifacts 192.168.100.15:/opt/jicki

scp -r channel-artifacts 192.168.100.91:/opt/jicki


</code></pre></td></tr></table></div></div><h2 id=配置-zookeeper-kafka-集群>配置 Zookeeper Kafka 集群</h2><blockquote><p>zookeeper 与 kafka 集群 必须在 所有服务器之间启动。</p></blockquote><h3 id=第一个节点-19216810067>第一个节点 (192.168.100.67)</h3><blockquote><p>ZOO_SERVERS 本机因为在 docker 里，需要配置为 0.0.0.0:2888:3888</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>vi docker-compose-zk-kafka.yaml


version: &#39;2&#39;
services:
  zookeeper0:
    container_name: zookeeper0
    hostname: zookeeper0
    image: zookeeper
    restart: always
    environment:
      - ZOO_MY_ID=1
      - ZOO_SERVERS=server.1=0.0.0.0:2888:3888 server.2=zookeeper1:2888:3888 server.3=zookeeper2:2888:3888
    #volumes:
    # 存储数据与日志
    #- ./data/zookeeper0/data:/data
    #- ./data/zookeeper0/datalog:/datalog
    ports:
      - 192.168.100.67:2181:2181 
      - 192.168.100.67:2888:2888
      - 192.168.100.67:3888:3888
      extra_hosts:
      - &#34;zookeeper0:192.168.100.67&#34;
      - &#34;zookeeper1:192.168.100.15&#34;
      - &#34;zookeeper2:192.168.100.91&#34;
      
  kafka0:
    container_name: kafka0
    hostname: kafka0
    image: hyperledger/fabric-kafka
    restart: always
    environment:
      - KAFKA_BROKER_ID=1
      # 设置一个M值,数据提交时会写入至少M个副本(这里M=2)（这些数据会被同步并且归属到in-sync 副本集合或ISR）M 必须小于 如下 N 值,并且大于1,既最小为2。
      - KAFKA_MIN_INSYNC_REPLICAS=2
      # 设置一个N值, N代表着每个channel都保存N个副本的数据到Kafka的代理上。N 必须大于如上 M 值, 既 N 值最小值为 3。
      - KAFKA_DEFAULT_REPLICATION_FACTOR=3
      - KAFKA_ZOOKEEPER_CONNECT=zookeeper0:2181,zookeeper1:2181,zookeeper2:2181
      # 如下99为configtx.yaml中会设置最大的区块大小(参考configtx.yaml中AbsoluteMaxBytes参数)
      # 每个区块最大有Orderer.AbsoluteMaxBytes个字节
      # 99 * 1024 * 1024 B
      - KAFKA_MESSAGE_MAX_BYTES=103809024
      # 每个通道获取的消息的字节数 如上一样
      - KAFKA_REPLICA_FETCH_MAX_BYTES=103809024
      # 数据一致性在区块链环境中是至关重要的, 我们不能从in-sync 副本（ISR）集合之外选取channel leader , 否则我们将会面临对于之前的leader产生的offsets覆盖的风险
      - KAFKA_UNCLEAN_LEADER_ELECTION_ENABLE=false
      # 关闭基于时间的日志保留方式并且避免分段到期。
      - KAFKA_LOG_RETENTION_MS=-1
    #volumes:
    # 存储数据与日志.
    #- ./data/kafka0/data:/data
    #- ./data/kafka0/data:/logs
    ports:
      - 192.168.100.67:9092:9092
    depends_on:
      - zookeeper0
    extra_hosts:
      - &#34;zookeeper0:192.168.100.67&#34;
      - &#34;zookeeper1:192.168.100.15&#34;
      - &#34;zookeeper2:192.168.100.91&#34;
      - &#34;kafka0:192.168.100.67&#34;
      - &#34;kafka1:192.168.100.15&#34;
      - &#34;kafka2:192.168.100.91&#34;
      
</code></pre></td></tr></table></div></div><h3 id=第二个节点-19216810015>第二个节点 (192.168.100.15)</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>vi docker-compose-zk-kafka.yaml


version: &#39;2&#39;
services:
  zookeeper1:
    container_name: zookeeper1
    hostname: zookeeper1
    image: zookeeper
    restart: always
    environment:
      - ZOO_MY_ID=2
      - ZOO_SERVERS=server.1=zookeeper0:2888:3888 server.2=0.0.0.0:2888:3888 server.3=zookeeper2:2888:3888
    #volumes:
    # 存储数据与日志
    #- ./data/zookeeper1/data:/data
    #- ./data/zookeeper1/datalog:/datalog
    ports:
      - 192.168.100.15:2181:2181
      - 192.168.100.15:2888:2888
      - 192.168.100.15:3888:3888
     extra_hosts:
      - &#34;zookeeper0:192.168.100.67&#34;
      - &#34;zookeeper1:192.168.100.15&#34;
      - &#34;zookeeper2:192.168.100.91&#34;
      
  kafka1:
    container_name: kafka1
    hostname: kafka1
    image: hyperledger/fabric-kafka
    restart: always
    environment:
      - KAFKA_BROKER_ID=2
      - KAFKA_MIN_INSYNC_REPLICAS=2
      - KAFKA_DEFAULT_REPLICATION_FACTOR=3
      - KAFKA_ZOOKEEPER_CONNECT=zookeeper0:2181,zookeeper1:2181,zookeeper2:2181
      - KAFKA_MESSAGE_MAX_BYTES=103809024
      - KAFKA_REPLICA_FETCH_MAX_BYTES=103809024
      - KAFKA_UNCLEAN_LEADER_ELECTION_ENABLE=false
      - KAFKA_LOG_RETENTION_MS=-1
    #volumes:
    # 存储数据与日志.
    #- ./data/kafka1/data:/data
    #- ./data/kafka1/data:/logs
    ports:
      - 192.168.100.15:9092:9092
    depends_on:
      - zookeeper1
    extra_hosts:
      - &#34;zookeeper0:192.168.100.67&#34;
      - &#34;zookeeper1:192.168.100.15&#34;
      - &#34;zookeeper2:192.168.100.91&#34;
      - &#34;kafka0:192.168.100.67&#34;
      - &#34;kafka1:192.168.100.15&#34;
      - &#34;kafka2:192.168.100.91&#34;
      
</code></pre></td></tr></table></div></div><h3 id=第三个节点-19216810091>第三个节点 (192.168.100.91)</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>vi docker-compose-zk-kafka.yaml


version: &#39;2&#39;
services:
  zookeeper2:
    container_name: zookeeper2
    hostname: zookeeper2
    image: zookeeper
    restart: always
    environment:
      - ZOO_MY_ID=3
      - ZOO_SERVERS=server.1=zookeeper0:2888:3888 server.2=zookeeper1:2888:3888 server.3=0.0.0.0:2888:3888
    #volumes:
    # 存储数据与日志
    #- ./data/zookeeper2/data:/data
    #- ./data/zookeeper2/datalog:/datalog
    ports:
      - 192.168.100.91:2181:2181
      - 192.168.100.91:2888:2888
      - 192.168.100.91:3888:3888
    extra_hosts:
      - &#34;zookeeper0:192.168.100.67&#34;
      - &#34;zookeeper1:192.168.100.15&#34;
      - &#34;zookeeper2:192.168.100.91&#34;
      
  kafka2:
    container_name: kafka2
    hostname: kafka2
    image: hyperledger/fabric-kafka
    restart: always
    environment:
      - KAFKA_BROKER_ID=3
      - KAFKA_MIN_INSYNC_REPLICAS=2
      - KAFKA_DEFAULT_REPLICATION_FACTOR=3
      - KAFKA_ZOOKEEPER_CONNECT=zookeeper0:2181,zookeeper1:2181,zookeeper2:2181
      - KAFKA_MESSAGE_MAX_BYTES=103809024
      - KAFKA_REPLICA_FETCH_MAX_BYTES=103809024
      - KAFKA_UNCLEAN_LEADER_ELECTION_ENABLE=false
      - KAFKA_LOG_RETENTION_MS=-1
    #volumes:
    # 存储数据与日志.
    #- ./data/kafka2/data:/data
    #- ./data/kafka2/data:/logs
    ports:
      - 192.168.100.91:9092:9092
    depends_on:
      - zookeeper2
    extra_hosts:
      - &#34;zookeeper0:192.168.100.67&#34;
      - &#34;zookeeper1:192.168.100.15&#34;
      - &#34;zookeeper2:192.168.100.91&#34;
      - &#34;kafka0:192.168.100.67&#34;
      - &#34;kafka1:192.168.100.15&#34;
      - &#34;kafka2:192.168.100.91&#34;
      
</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 分别启动服务

docker-compose -f docker-compose-zk-kafka.yaml up -d




</code></pre></td></tr></table></div></div><h2 id=配置-hyperledger-fabric-orderer>配置 Hyperledger Fabric Orderer</h2><h3 id=第一个节点-19216810067-1>第一个节点 (192.168.100.67)</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 创建文件 docker-compose-orderer.yaml

# 创建于 /opt/jicki 目录下

vi  docker-compose-orderer.yaml


version: &#39;2&#39;
services:
  orderer0.jicki.cn:
    container_name: orderer0.jicki.cn
    image: hyperledger/fabric-orderer
    environment:
      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=jicki_default
      # - ORDERER_GENERAL_LOGLEVEL=error
      - ORDERER_GENERAL_LOGLEVEL=debug
      - ORDERER_GENERAL_LISTENADDRESS=0.0.0.0
      - ORDERER_GENERAL_LISTENPORT=7050
      #- ORDERER_GENERAL_GENESISPROFILE=AntiMothOrdererGenesis
      - ORDERER_GENERAL_GENESISMETHOD=file
      - ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block
      - ORDERER_GENERAL_LOCALMSPID=OrdererMSP
      - ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp
      #- ORDERER_GENERAL_LEDGERTYPE=ram
      #- ORDERER_GENERAL_LEDGERTYPE=file
      # enabled TLS
      - ORDERER_GENERAL_TLS_ENABLED=false
      - ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key
      - ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt
      - ORDERER_GENERAL_TLS_ROOTCAS=[/var/hyperledger/orderer/tls/ca.crt]

      # KAFKA
      - ORDERER_KAFKA_RETRY_LONGINTERVAL=10s
      - ORDERER_KAFKA_RETRY_LONGTOTAL=100s
      - ORDERER_KAFKA_RETRY_SHORTINTERVAL=1s
      - ORDERER_KAFKA_RETRY_SHORTTOTAL=30s
      - ORDERER_KAFKA_VERBOSE=true
      - ORDERER_KAFKA_BROKERS=[kafka0:9092,kafka1:9092,kafka2:9092]
    working_dir: /opt/gopath/src/github.com/hyperledger/fabric
    command: orderer
    volumes:
    - ./channel-artifacts/genesis.block:/var/hyperledger/orderer/orderer.genesis.block
    - ./crypto-config/ordererOrganizations/jicki.cn/orderers/orderer0.jicki.cn/msp:/var/hyperledger/orderer/msp
    - ./crypto-config/ordererOrganizations/jicki.cn/orderers/orderer0.jicki.cn/tls/:/var/hyperledger/orderer/tls
    ports:
      - 7050:7050
    extra_hosts:
      - &#34;zookeeper0:192.168.100.67&#34;
      - &#34;zookeeper1:192.168.100.15&#34;
      - &#34;zookeeper2:192.168.100.91&#34;
      - &#34;kafka0:192.168.100.67&#34;
      - &#34;kafka1:192.168.100.15&#34;
      - &#34;kafka2:192.168.100.91&#34;
      
</code></pre></td></tr></table></div></div><h3 id=第二个节点-19216810015-1>第二个节点 (192.168.100.15)</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 创建文件 docker-compose-orderer.yaml

# 创建于 /opt/jicki 目录下

vi  docker-compose-orderer.yaml


version: &#39;2&#39;
services:
  orderer1.jicki.cn:
    container_name: orderer1.jicki.cn
    image: hyperledger/fabric-orderer
    environment:
      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=jicki_default
      # - ORDERER_GENERAL_LOGLEVEL=error
      - ORDERER_GENERAL_LOGLEVEL=debug
      - ORDERER_GENERAL_LISTENADDRESS=0.0.0.0
      - ORDERER_GENERAL_LISTENPORT=7050
      #- ORDERER_GENERAL_GENESISPROFILE=AntiMothOrdererGenesis
      - ORDERER_GENERAL_GENESISMETHOD=file
      - ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block
      - ORDERER_GENERAL_LOCALMSPID=OrdererMSP
      - ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp
      #- ORDERER_GENERAL_LEDGERTYPE=ram
      #- ORDERER_GENERAL_LEDGERTYPE=file
      # enabled TLS
      - ORDERER_GENERAL_TLS_ENABLED=false
      - ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key
      - ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt
      - ORDERER_GENERAL_TLS_ROOTCAS=[/var/hyperledger/orderer/tls/ca.crt]
      
      # KAFKA
      - ORDERER_KAFKA_RETRY_LONGINTERVAL=10s
      - ORDERER_KAFKA_RETRY_LONGTOTAL=100s
      - ORDERER_KAFKA_RETRY_SHORTINTERVAL=1s
      - ORDERER_KAFKA_RETRY_SHORTTOTAL=30s
      - ORDERER_KAFKA_VERBOSE=true
      - ORDERER_KAFKA_BROKERS=[kafka0:9092,kafka1:9092,kafka2:9092]
    working_dir: /opt/gopath/src/github.com/hyperledger/fabric
    command: orderer
    volumes:
    - ./channel-artifacts/genesis.block:/var/hyperledger/orderer/orderer.genesis.block
    - ./crypto-config/ordererOrganizations/jicki.cn/orderers/orderer1.jicki.cn/msp:/var/hyperledger/orderer/msp
    - ./crypto-config/ordererOrganizations/jicki.cn/orderers/orderer1.jicki.cn/tls/:/var/hyperledger/orderer/tls
    ports:
      - 7050:7050
    extra_hosts:
      - &#34;zookeeper0:192.168.100.67&#34;
      - &#34;zookeeper1:192.168.100.15&#34;
      - &#34;zookeeper2:192.168.100.91&#34;
      - &#34;kafka0:192.168.100.67&#34;
      - &#34;kafka1:192.168.100.15&#34;
      - &#34;kafka2:192.168.100.91&#34;
      
</code></pre></td></tr></table></div></div><h3 id=第三个节点-19216810091-1>第三个节点 (192.168.100.91)</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 创建文件 docker-compose-orderer.yaml

# 创建于 /opt/jicki 目录下

vi  docker-compose-orderer.yaml


version: &#39;2&#39;
services:
  orderer2.jicki.cn:
    container_name: orderer2.jicki.cn
    image: hyperledger/fabric-orderer
    environment:
      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=jicki_default
      # - ORDERER_GENERAL_LOGLEVEL=error
      - ORDERER_GENERAL_LOGLEVEL=debug
      - ORDERER_GENERAL_LISTENADDRESS=0.0.0.0
      - ORDERER_GENERAL_LISTENPORT=7050
      #- ORDERER_GENERAL_GENESISPROFILE=AntiMothOrdererGenesis
      - ORDERER_GENERAL_GENESISMETHOD=file
      - ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block
      - ORDERER_GENERAL_LOCALMSPID=OrdererMSP
      - ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp
      #- ORDERER_GENERAL_LEDGERTYPE=ram
      #- ORDERER_GENERAL_LEDGERTYPE=file
      # enabled TLS
      - ORDERER_GENERAL_TLS_ENABLED=false
      - ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key
      - ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt
      - ORDERER_GENERAL_TLS_ROOTCAS=[/var/hyperledger/orderer/tls/ca.crt]
      
      # KAFKA
      - ORDERER_KAFKA_RETRY_LONGINTERVAL=10s
      - ORDERER_KAFKA_RETRY_LONGTOTAL=100s
      - ORDERER_KAFKA_RETRY_SHORTINTERVAL=1s
      - ORDERER_KAFKA_RETRY_SHORTTOTAL=30s
      - ORDERER_KAFKA_VERBOSE=true
      - ORDERER_KAFKA_BROKERS=[kafka0:9092,kafka1:9092,kafka2:9092]
    working_dir: /opt/gopath/src/github.com/hyperledger/fabric
    command: orderer
    volumes:
    - ./channel-artifacts/genesis.block:/var/hyperledger/orderer/orderer.genesis.block
    - ./crypto-config/ordererOrganizations/jicki.cn/orderers/orderer2.jicki.cn/msp:/var/hyperledger/orderer/msp
    - ./crypto-config/ordererOrganizations/jicki.cn/orderers/orderer2.jicki.cn/tls/:/var/hyperledger/orderer/tls
    ports:
      - 7050:7050
    extra_hosts:
      - &#34;zookeeper0:192.168.100.67&#34;
      - &#34;zookeeper1:192.168.100.15&#34;
      - &#34;zookeeper2:192.168.100.91&#34;
      - &#34;kafka0:192.168.100.67&#34;
      - &#34;kafka1:192.168.100.15&#34;
      - &#34;kafka2:192.168.100.91&#34;
      
</code></pre></td></tr></table></div></div><h3 id=启动服务>启动服务</h3><blockquote><p>所有节点启动服务</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>docker-compose -f docker-compose-orderer.yaml up -d


# 启动完毕，查看docker logs 如下表示成功



2018-08-07 01:42:14.431 UTC [orderer/consensus/kafka] processMessagesToBlocks -&gt; DEBU 2fd [channel: testchainid] Successfully unmarshalled consumed message, offset is 0. Inspecting type...
2018-08-07 01:42:14.431 UTC [orderer/consensus/kafka] processConnect -&gt; DEBU 2fe [channel: testchainid] It&#39;s a connect message - ignoring
2018-08-07 01:42:14.431 UTC [orderer/consensus/kafka] processMessagesToBlocks -&gt; DEBU 2ff [channel: testchainid] Successfully unmarshalled consumed message, offset is 1. Inspecting type...
2018-08-07 01:42:14.431 UTC [orderer/consensus/kafka] processConnect -&gt; DEBU 300 [channel: testchainid] It&#39;s a connect message - ignoring
2018-08-07 01:42:14.431 UTC [orderer/consensus/kafka] processMessagesToBlocks -&gt; DEBU 301 [channel: testchainid] Successfully unmarshalled consumed message, offset is 2. Inspecting type...
2018-08-07 01:42:14.431 UTC [orderer/consensus/kafka] processConnect -&gt; DEBU 302 [channel: testchainid] It&#39;s a connect message - ignoring

</code></pre></td></tr></table></div></div><h2 id=配置-hyperledger-fabric-peer>配置 Hyperledger Fabric peer</h2><blockquote><p>节点下都必须启动一个数据存储，如 file 或者 couchdb 等</p></blockquote><h3 id=第二个节点-19216810015-2>第二个节点 (192.168.100.15)</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>vi  docker-compose-peer.yaml

version: &#39;2&#39;
services:
  couchdb0:
    container_name: couchdb0
    image: hyperledger/fabric-couchdb
    environment:
      - COUCHDB_USER=
      - COUCHDB_PASSWORD=
    ports:
      - &#34;5984:5984&#34;
    #volumes:
      # 数据持久化，用于存储链码值
      #- ./data/couchdb0/data:/opt/couchdb/data
      
  peer0.org1.jicki.cn:
    container_name: peer0.org1.jicki.cn
    image: hyperledger/fabric-peer
    environment:
      - CORE_LEDGER_STATE_STATEDATABASE=CouchDB
      - CORE_LEDGER_STATE_COUCHDBCONFIG_COUCHDBADDRESS=couchdb0:5984
      
      - CORE_PEER_ID=peer0.org1.jicki.cn
      - CORE_PEER_NETWORKID=jicki
      - CORE_PEER_ADDRESS=peer0.org1.jicki.cn:7051
      - CORE_PEER_CHAINCODELISTENADDRESS=peer0.org1.jicki.cn:7052
      - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org1.jicki.cn:7051
      - CORE_PEER_LOCALMSPID=Org1MSP

      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock
      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=jicki
      # - CORE_LOGGING_LEVEL=ERROR
      - CORE_LOGGING_LEVEL=DEBUG
      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=jicki_default
      - CORE_PEER_GOSSIP_SKIPHANDSHAKE=true
      - CORE_PEER_GOSSIP_USELEADERELECTION=true
      - CORE_PEER_GOSSIP_ORGLEADER=false
      - CORE_PEER_PROFILE_ENABLED=false
      - CORE_PEER_TLS_ENABLED=false
      - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt
      - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key
      - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt
    volumes:
        - /var/run/:/host/var/run/
        - ./crypto-config/peerOrganizations/org1.jicki.cn/peers/peer0.org1.jicki.cn/msp:/etc/hyperledger/fabric/msp
        - ./crypto-config/peerOrganizations/org1.jicki.cn/peers/peer0.org1.jicki.cn/tls:/etc/hyperledger/fabric/tls
        # 数据持久化, 存储安装，以及实例化智能合约的数据
        - ./data/peer0org1:/var/hyperledger/production
    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer
    command: peer node start
    ports:
      - 7051:7051
      - 7052:7052
      - 7053:7053
    depends_on:
      - couchdb0
    extra_hosts:
      - &#34;couchdb0:192.168.100.15&#34;
      - &#34;orderer0.jicki.cn:192.168.100.67&#34;
      - &#34;orderer1.jicki.cn:192.168.100.15&#34;
      - &#34;orderer2.jicki.cn:192.168.100.91&#34;

</code></pre></td></tr></table></div></div><h3 id=第三个节点-19216810091-2>第三个节点 (192.168.100.91)</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>vi  docker-compose-peer.yaml


version: &#39;2&#39;
services:
  couchdb1:
    container_name: couchdb1
    image: hyperledger/fabric-couchdb
    environment:
      - COUCHDB_USER=
      - COUCHDB_PASSWORD=
    ports:
      - &#34;5984:5984&#34;
    #volumes:
      # 数据持久化，用于存储链码值
      #- ./data/couchdb1/data:/opt/couchdb/data
      
  peer0.org2.jicki.cn:
    container_name: peer0.org2.jicki.cn
    image: hyperledger/fabric-peer
    environment:
      - CORE_LEDGER_STATE_STATEDATABASE=CouchDB
      - CORE_LEDGER_STATE_COUCHDBCONFIG_COUCHDBADDRESS=couchdb1:5984
      
      - CORE_PEER_ID=peer0.org2.jicki.cn
      - CORE_PEER_NETWORKID=jicki
      - CORE_PEER_ADDRESS=peer0.org2.jicki.cn:7051
      - CORE_PEER_CHAINCODELISTENADDRESS=peer0.org2.jicki.cn:7052
      - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org2.jicki.cn:7051
      - CORE_PEER_LOCALMSPID=Org2MSP

      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock
      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=jicki
      # - CORE_LOGGING_LEVEL=ERROR
      - CORE_LOGGING_LEVEL=DEBUG
      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=jicki_default
      - CORE_PEER_GOSSIP_SKIPHANDSHAKE=true
      - CORE_PEER_GOSSIP_USELEADERELECTION=true
      - CORE_PEER_GOSSIP_ORGLEADER=false
      - CORE_PEER_PROFILE_ENABLED=false
      - CORE_PEER_TLS_ENABLED=false
      - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt
      - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key
      - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt
    volumes:
        - /var/run/:/host/var/run/
        - ./crypto-config/peerOrganizations/org2.jicki.cn/peers/peer0.org2.jicki.cn/msp:/etc/hyperledger/fabric/msp
        - ./crypto-config/peerOrganizations/org2.jicki.cn/peers/peer0.org2.jicki.cn/tls:/etc/hyperledger/fabric/tls
        # 数据持久化, 存储安装，以及实例化智能合约的数据
        - ./data/peer0org2:/var/hyperledger/production
    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer
    command: peer node start
    ports:
      - 7051:7051
      - 7052:7052
      - 7053:7053
    depends_on:
      - couchdb1
    extra_hosts:
      - &#34;couchdb1:192.168.100.91&#34;
      - &#34;orderer0.jicki.cn:192.168.100.67&#34;
      - &#34;orderer1.jicki.cn:192.168.100.15&#34;
      - &#34;orderer2.jicki.cn:192.168.100.91&#34;

</code></pre></td></tr></table></div></div><h3 id=启动服务-1>启动服务</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>docker-compose -f docker-compose-peer.yaml up -d


# 查看 docker logs 输出如下, 既为成功


# 第二个节点

2018-08-07 02:05:20.638 UTC [discovery] NewService -&gt; INFO 122 Created with config TLS: false, authCacheMaxSize: 1000, authCachePurgeRatio: 0.750000
2018-08-07 02:05:20.638 UTC [nodeCmd] registerDiscoveryService -&gt; INFO 123 Discovery service activated
2018-08-07 02:05:20.638 UTC [nodeCmd] serve -&gt; INFO 124 Starting peer with ID=[name:&#34;peer0.org1.jicki.cn&#34; ], network ID=[jicki], address=[peer0.org1.jicki.cn:7051]
2018-08-07 02:05:20.638 UTC [nodeCmd] serve -&gt; INFO 125 Started peer with ID=[name:&#34;peer0.org1.jicki.cn&#34; ], network ID=[jicki], address=[peer0.org1.jicki.cn:7051]



# 第三个节点

2018-08-07 02:07:23.628 UTC [discovery] NewService -&gt; INFO 133 Created with config TLS: false, authCacheMaxSize: 1000, authCachePurgeRatio: 0.750000
2018-08-07 02:07:23.628 UTC [nodeCmd] registerDiscoveryService -&gt; INFO 134 Discovery service activated
2018-08-07 02:07:23.628 UTC [nodeCmd] serve -&gt; INFO 135 Starting peer with ID=[name:&#34;peer0.org2.jicki.cn&#34; ], network ID=[jicki], address=[peer0.org2.jicki.cn:7051]
2018-08-07 02:07:23.628 UTC [nodeCmd] serve -&gt; INFO 136 Started peer with ID=[name:&#34;peer0.org2.jicki.cn&#34; ], network ID=[jicki], address=[peer0.org2.jicki.cn:7051]


</code></pre></td></tr></table></div></div><h2 id=配置-hyperledger-fabric-cli-客户端>配置 Hyperledger Fabric cli 客户端</h2><blockquote><p>客户端服务，只需要配置一个既可，这里配置再 第一个节点中，用于调用创建 channel 与 智能合约</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>vi  docker-compose-cli.yaml


version: &#39;2&#39;
services:
  cli:
    container_name: cli
    image: hyperledger/fabric-tools
    tty: true
    environment:
      - GOPATH=/opt/gopath
      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock
      # - CORE_LOGGING_LEVEL=ERROR
      - CORE_LOGGING_LEVEL=DEBUG
      - CORE_PEER_ID=cli
      - CORE_PEER_ADDRESS=peer0.org1.jicki.cn:7051
      - CORE_PEER_LOCALMSPID=Org1MSP
      - CORE_PEER_TLS_ENABLED=false
      - CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.jicki.cn/peers/peer0.org1.jicki.cn/tls/server.crt
      - CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.jicki.cn/peers/peer0.org1.jicki.cn/tls/server.key
      - CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.jicki.cn/peers/peer0.org1.jicki.cn/tls/ca.crt
      - CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.jicki.cn/users/Admin@org1.jicki.cn/msp
    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer
    volumes:
        - /var/run/:/host/var/run/
        - /opt/golang/go:/opt/go
        - /opt/gopath:/opt/gopath
        - ./peer:/opt/gopath/src/github.com/hyperledger/fabric/peer
        - ./chaincode/go/:/opt/gopath/src/github.com/hyperledger/fabric/jicki/chaincode/go
        - ./crypto-config:/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/
        - ./channel-artifacts:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel-artifacts
    extra_hosts:
      - &#34;orderer0.jicki.cn:192.168.100.67&#34;
      - &#34;orderer1.jicki.cn:192.168.100.15&#34;
      - &#34;orderer2.jicki.cn:192.168.100.91&#34;
      - &#34;peer0.org1.jicki.cn:192.168.100.15&#34;
      - &#34;peer0.org2.jicki.cn:192.168.100.91&#34;
</code></pre></td></tr></table></div></div><h3 id=启动服务-2>启动服务</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>docker-compose -f docker-compose-cli.yaml up -d

</code></pre></td></tr></table></div></div><h2 id=hyperledger-fabric-创建-channel>Hyperledger Fabric 创建 Channel</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 上面我们创建了 cli 容器，我们可以直接进入 容器里操作


[root@localhost jicki]# docker exec -it cli bash
root@77962643125a:/opt/gopath/src/github.com/hyperledger/fabric/peer# 


# 执行 创建命令 (未启动 认证)

peer channel create -c mychannel -f ./channel-artifacts/channel.tx --orderer orderer0.jicki.cn:7050


# 以下为启用认证

peer channel create -o orderer0.jicki.cn:7050 -c mychannel -f ./channel-artifacts/channel.tx --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/jicki.cn/orderers/orderer0.jicki.cn/msp/tlscacerts/tlsca.jicki.cn-cert.pem




# 输出如下:

2018-08-07 02:20:49.574 UTC [grpc] Printf -&gt; DEBU 094 parsed scheme: &#34;&#34;
2018-08-07 02:20:49.574 UTC [grpc] Printf -&gt; DEBU 095 scheme &#34;&#34; not registered, fallback to default scheme
2018-08-07 02:20:49.574 UTC [grpc] Printf -&gt; DEBU 096 ccResolverWrapper: sending new addresses to cc: [{orderer0.jicki.cn:7050 0  &lt;nil&gt;}]
2018-08-07 02:20:49.574 UTC [grpc] Printf -&gt; DEBU 097 ClientConn switching balancer to &#34;pick_first&#34;
2018-08-07 02:20:49.574 UTC [grpc] Printf -&gt; DEBU 098 pickfirstBalancer: HandleSubConnStateChange: 0xc420281c80, CONNECTING
2018-08-07 02:20:49.575 UTC [grpc] Printf -&gt; DEBU 099 pickfirstBalancer: HandleSubConnStateChange: 0xc420281c80, READY
2018-08-07 02:20:49.575 UTC [channelCmd] InitCmdFactory -&gt; INFO 09a Endorser and orderer connections initialized
2018-08-07 02:20:49.775 UTC [msp] GetDefaultSigningIdentity -&gt; DEBU 09b Obtaining default signing identity
2018-08-07 02:20:49.775 UTC [msp] GetDefaultSigningIdentity -&gt; DEBU 09c Obtaining default signing identity
2018-08-07 02:20:49.775 UTC [msp/identity] Sign -&gt; DEBU 09d Sign: plaintext: 0AD1060A1508051A06088184A4DB0522...2FB3601B298B12080A021A0012021A00 
2018-08-07 02:20:49.775 UTC [msp/identity] Sign -&gt; DEBU 09e Sign: digest: DE4E562C31BC2BA09C70978648AAE7EC6F81BC49BF5D6AE8760FD64B84F3541C 
2018-08-07 02:20:49.777 UTC [cli/common] readBlock -&gt; INFO 09f Received block: 0




# 创建以后生成文件 mychannel.block

total 24
-rw-r--r-- 1 root root 15382 Aug  7 02:20 mychannel.block
drwxr-xr-x 2 root root  4096 Aug  6 09:16 channel-artifacts
drwxr-xr-x 4 root root  4096 Aug  6 06:45 crypto

</code></pre></td></tr></table></div></div><h2 id=hyperledger-fabric-加入-channel>Hyperledger Fabric 加入 Channel</h2><blockquote><p>我们这边有2个 peer 所以需要分别加入, 后续有多少个 peer 都需要加入到 Channel 中</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># peer0.org1.jicki.cn 加入 此 channel 中，首先需要查看如下 环境变量


echo $CORE_PEER_LOCALMSPID
echo $CORE_PEER_ADDRESS
echo $CORE_PEER_MSPCONFIGPATH
echo $CORE_PEER_TLS_ROOTCERT_FILE


# 加入 channel

peer channel join -b mychannel.block


# 输出如下: 

2018-08-07 02:31:52.810 UTC [msp] setupSigningIdentity -&gt; DEBU 035 Signing identity expires at 2028-08-03 06:40:54 +0000 UTC
2018-08-07 02:31:52.811 UTC [msp] Validate -&gt; DEBU 036 MSP Org1MSP validating identity
2018-08-07 02:31:52.811 UTC [msp] GetDefaultSigningIdentity -&gt; DEBU 037 Obtaining default signing identity
2018-08-07 02:31:52.811 UTC [grpc] Printf -&gt; DEBU 038 parsed scheme: &#34;&#34;
2018-08-07 02:31:52.811 UTC [grpc] Printf -&gt; DEBU 039 scheme &#34;&#34; not registered, fallback to default scheme
2018-08-07 02:31:52.811 UTC [grpc] Printf -&gt; DEBU 03a ccResolverWrapper: sending new addresses to cc: [{peer0.org1.jicki.cn:7051 0  &lt;nil&gt;}]
2018-08-07 02:31:52.811 UTC [grpc] Printf -&gt; DEBU 03b ClientConn switching balancer to &#34;pick_first&#34;
2018-08-07 02:31:52.811 UTC [grpc] Printf -&gt; DEBU 03c pickfirstBalancer: HandleSubConnStateChange: 0xc4203cb530, CONNECTING
2018-08-07 02:31:52.812 UTC [grpc] Printf -&gt; DEBU 03d pickfirstBalancer: HandleSubConnStateChange: 0xc4203cb530, READY
2018-08-07 02:31:52.812 UTC [channelCmd] InitCmdFactory -&gt; INFO 03e Endorser and orderer connections initialized
2018-08-07 02:31:52.813 UTC [msp/identity] Sign -&gt; DEBU 03f Sign: plaintext: 0A98070A5C08011A0C089889A4DB0510...131231D39FB81A080A000A000A000A00 
2018-08-07 02:31:52.813 UTC [msp/identity] Sign -&gt; DEBU 040 Sign: digest: E9D23EC60B2EDFA54AD140AB09299DCF3FA11A657D85743E58A15BC02FE38743 
2018-08-07 02:31:52.902 UTC [channelCmd] executeJoin -&gt; INFO 041 Successfully submitted proposal to join channel


</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># peer1.org2.jicki.cn 加入 此 channel 中，这里配置一下环境变量

export CORE_PEER_LOCALMSPID=&#34;Org2MSP&#34;
export CORE_PEER_ADDRESS=peer0.org2.jicki.cn:7051
export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.jicki.cn/peers/peer0.org2.jicki.cn/tls/ca.crt
export CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.jicki.cn/users/Admin@org2.jicki.cn/msp


# 加入 channel

peer channel join -b mychannel.block



# 输入如下:

2018-08-07 02:32:23.864 UTC [msp] setupSigningIdentity -&gt; DEBU 035 Signing identity expires at 2028-08-03 06:40:54 +0000 UTC
2018-08-07 02:32:23.864 UTC [msp] Validate -&gt; DEBU 036 MSP Org2MSP validating identity
2018-08-07 02:32:23.865 UTC [msp] GetDefaultSigningIdentity -&gt; DEBU 037 Obtaining default signing identity
2018-08-07 02:32:23.865 UTC [grpc] Printf -&gt; DEBU 038 parsed scheme: &#34;&#34;
2018-08-07 02:32:23.865 UTC [grpc] Printf -&gt; DEBU 039 scheme &#34;&#34; not registered, fallback to default scheme
2018-08-07 02:32:23.865 UTC [grpc] Printf -&gt; DEBU 03a ccResolverWrapper: sending new addresses to cc: [{peer0.org2.jicki.cn:7051 0  &lt;nil&gt;}]
2018-08-07 02:32:23.865 UTC [grpc] Printf -&gt; DEBU 03b ClientConn switching balancer to &#34;pick_first&#34;
2018-08-07 02:32:23.865 UTC [grpc] Printf -&gt; DEBU 03c pickfirstBalancer: HandleSubConnStateChange: 0xc420ca8bf0, CONNECTING
2018-08-07 02:32:23.866 UTC [grpc] Printf -&gt; DEBU 03d pickfirstBalancer: HandleSubConnStateChange: 0xc420ca8bf0, READY
2018-08-07 02:32:23.866 UTC [channelCmd] InitCmdFactory -&gt; INFO 03e Endorser and orderer connections initialized
2018-08-07 02:32:23.867 UTC [msp/identity] Sign -&gt; DEBU 03f Sign: plaintext: 0A98070A5C08011A0C08B789A4DB0510...131231D39FB81A080A000A000A000A00 
2018-08-07 02:32:23.867 UTC [msp/identity] Sign -&gt; DEBU 040 Sign: digest: 620FDAF5EA0CAC6FB6FEC4B16910082B6E471EA03688AB0095A71DC58F280E0B 
2018-08-07 02:32:23.955 UTC [channelCmd] executeJoin -&gt; INFO 041 Successfully submitted proposal to join channel

</code></pre></td></tr></table></div></div><h2 id=hyperledger-fabric-锚节点>Hyperledger Fabric 锚节点</h2><blockquote><p>锚节点通过广播的方式通知有新节点加入</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 使用Org1的管理员身份更新锚节点配置 

# 同样需要先配置变量

export CORE_PEER_LOCALMSPID=&#34;Org1MSP&#34;
export CORE_PEER_ADDRESS=peer0.org1.jicki.cn:7051
export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.jicki.cn/peers/peer0.org1.jicki.cn/tls/ca.crt
export CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.jicki.cn/users/Admin@org1.jicki.cn/msp



# 未开启认证的方式

peer channel update -o orderer0.jicki.cn:7050 -c mychannel -f ./channel-artifacts/Org1MSPanchors.tx



# 开启认证的方式

peer channel update -o orderer0.jicki.cn:7050 -c mychannel -f ./channel-artifacts/Org1MSPanchors.tx --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/jicki.cn/orderers/orderer0.jicki.cn/msp/tlscacerts/tlsca.jicki.cn-cert.pem



# 输出如下:

2018-08-07 02:45:16.093 UTC [msp] setupSigningIdentity -&gt; DEBU 035 Signing identity expires at 2028-08-03 06:40:54 +0000 UTC
2018-08-07 02:45:16.093 UTC [msp] Validate -&gt; DEBU 036 MSP Org1MSP validating identity
2018-08-07 02:45:16.093 UTC [msp] GetDefaultSigningIdentity -&gt; DEBU 037 Obtaining default signing identity
2018-08-07 02:45:16.093 UTC [grpc] Printf -&gt; DEBU 038 parsed scheme: &#34;&#34;
2018-08-07 02:45:16.093 UTC [grpc] Printf -&gt; DEBU 039 scheme &#34;&#34; not registered, fallback to default scheme
2018-08-07 02:45:16.093 UTC [grpc] Printf -&gt; DEBU 03a ccResolverWrapper: sending new addresses to cc: [{orderer0.jicki.cn:7050 0  &lt;nil&gt;}]
2018-08-07 02:45:16.093 UTC [grpc] Printf -&gt; DEBU 03b ClientConn switching balancer to &#34;pick_first&#34;
2018-08-07 02:45:16.093 UTC [grpc] Printf -&gt; DEBU 03c pickfirstBalancer: HandleSubConnStateChange: 0xc4201fe5e0, CONNECTING
2018-08-07 02:45:16.094 UTC [grpc] Printf -&gt; DEBU 03d pickfirstBalancer: HandleSubConnStateChange: 0xc4201fe5e0, READY
2018-08-07 02:45:16.094 UTC [channelCmd] InitCmdFactory -&gt; INFO 03e Endorser and orderer connections initialized
2018-08-07 02:45:16.094 UTC [msp] GetDefaultSigningIdentity -&gt; DEBU 03f Obtaining default signing identity
2018-08-07 02:45:16.094 UTC [msp] GetDefaultSigningIdentity -&gt; DEBU 040 Obtaining default signing identity
2018-08-07 02:45:16.094 UTC [msp/identity] Sign -&gt; DEBU 041 Sign: plaintext: 0A9A060A074F7267314D5350128E062D...2A0641646D696E732A0641646D696E73 
2018-08-07 02:45:16.094 UTC [msp/identity] Sign -&gt; DEBU 042 Sign: digest: B9EBDD95115ECC8722C7E5D917CE7AB428AF8F7921A55D01D988488B24EBCA64 
2018-08-07 02:45:16.094 UTC [msp] GetDefaultSigningIdentity -&gt; DEBU 043 Obtaining default signing identity
2018-08-07 02:45:16.094 UTC [msp] GetDefaultSigningIdentity -&gt; DEBU 044 Obtaining default signing identity
2018-08-07 02:45:16.094 UTC [msp/identity] Sign -&gt; DEBU 045 Sign: plaintext: 0AD1060A1508021A0608BC8FA4DB0522...223072D3C517446F35F9431FCE53B9AD 
2018-08-07 02:45:16.094 UTC [msp/identity] Sign -&gt; DEBU 046 Sign: digest: 6B483C98171C37B2FBD318E27AC73DD68277C3719CAA04719225672B028ABABD 
2018-08-07 02:45:16.094 UTC [grpc] Printf -&gt; DEBU 047 parsed scheme: &#34;&#34;
2018-08-07 02:45:16.094 UTC [grpc] Printf -&gt; DEBU 048 scheme &#34;&#34; not registered, fallback to default scheme
2018-08-07 02:45:16.094 UTC [grpc] Printf -&gt; DEBU 049 ccResolverWrapper: sending new addresses to cc: [{orderer0.jicki.cn:7050 0  &lt;nil&gt;}]
2018-08-07 02:45:16.094 UTC [grpc] Printf -&gt; DEBU 04a ClientConn switching balancer to &#34;pick_first&#34;
2018-08-07 02:45:16.095 UTC [grpc] Printf -&gt; DEBU 04b pickfirstBalancer: HandleSubConnStateChange: 0xc4201fef50, CONNECTING
2018-08-07 02:45:16.095 UTC [grpc] Printf -&gt; DEBU 04c pickfirstBalancer: HandleSubConnStateChange: 0xc4201fef50, READY
2018-08-07 02:45:16.214 UTC [channelCmd] update -&gt; INFO 04d Successfully submitted channel update

</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 使用Org2的管理员身份更新锚节点配置 

# 同样需要先配置变量

export CORE_PEER_LOCALMSPID=&#34;Org2MSP&#34;
export CORE_PEER_ADDRESS=peer0.org2.jicki.cn:7051
export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.jicki.cn/peers/peer0.org2.jicki.cn/tls/ca.crt
export CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.jicki.cn/users/Admin@org2.jicki.cn/msp


# 未开启认证的方式

peer channel update -o orderer0.jicki.cn:7050 -c mychannel -f ./channel-artifacts/Org2MSPanchors.tx



# 开启认证的方式

peer channel update -o orderer0.jicki.cn:7050 -c mychannel -f ./channel-artifacts/Org2MSPanchors.tx --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/jicki.cn/orderers/orderer0.jicki.cn/msp/tlscacerts/tlsca.jicki.cn-cert.pem


# 输出如下:

2018-08-07 02:45:36.285 UTC [msp] setupSigningIdentity -&gt; DEBU 035 Signing identity expires at 2028-08-03 06:40:54 +0000 UTC
2018-08-07 02:45:36.285 UTC [msp] Validate -&gt; DEBU 036 MSP Org2MSP validating identity
2018-08-07 02:45:36.286 UTC [msp] GetDefaultSigningIdentity -&gt; DEBU 037 Obtaining default signing identity
2018-08-07 02:45:36.286 UTC [grpc] Printf -&gt; DEBU 038 parsed scheme: &#34;&#34;
2018-08-07 02:45:36.286 UTC [grpc] Printf -&gt; DEBU 039 scheme &#34;&#34; not registered, fallback to default scheme
2018-08-07 02:45:36.286 UTC [grpc] Printf -&gt; DEBU 03a ccResolverWrapper: sending new addresses to cc: [{orderer0.jicki.cn:7050 0  &lt;nil&gt;}]
2018-08-07 02:45:36.286 UTC [grpc] Printf -&gt; DEBU 03b ClientConn switching balancer to &#34;pick_first&#34;
2018-08-07 02:45:36.286 UTC [grpc] Printf -&gt; DEBU 03c pickfirstBalancer: HandleSubConnStateChange: 0xc42025a560, CONNECTING
2018-08-07 02:45:36.286 UTC [grpc] Printf -&gt; DEBU 03d pickfirstBalancer: HandleSubConnStateChange: 0xc42025a560, READY
2018-08-07 02:45:36.287 UTC [channelCmd] InitCmdFactory -&gt; INFO 03e Endorser and orderer connections initialized
2018-08-07 02:45:36.287 UTC [msp] GetDefaultSigningIdentity -&gt; DEBU 03f Obtaining default signing identity
2018-08-07 02:45:36.287 UTC [msp] GetDefaultSigningIdentity -&gt; DEBU 040 Obtaining default signing identity
2018-08-07 02:45:36.287 UTC [msp/identity] Sign -&gt; DEBU 041 Sign: plaintext: 0A9A060A074F7267324D5350128E062D...2A0641646D696E732A0641646D696E73 
2018-08-07 02:45:36.287 UTC [msp/identity] Sign -&gt; DEBU 042 Sign: digest: 1A11594F70194B6D24D4D5416310F049D0D292447F3A9624AC3612F36E2CA424 
2018-08-07 02:45:36.287 UTC [msp] GetDefaultSigningIdentity -&gt; DEBU 043 Obtaining default signing identity
2018-08-07 02:45:36.287 UTC [msp] GetDefaultSigningIdentity -&gt; DEBU 044 Obtaining default signing identity
2018-08-07 02:45:36.287 UTC [msp/identity] Sign -&gt; DEBU 045 Sign: plaintext: 0AD1060A1508021A0608D08FA4DB0522...C2F2ED2EF0B45937BFCDDE5333EED203 
2018-08-07 02:45:36.287 UTC [msp/identity] Sign -&gt; DEBU 046 Sign: digest: 8130CD8476B357A487219831107C06F93DC8AE12DF9CB2EB04BB199802467E58 
2018-08-07 02:45:36.287 UTC [grpc] Printf -&gt; DEBU 047 parsed scheme: &#34;&#34;
2018-08-07 02:45:36.287 UTC [grpc] Printf -&gt; DEBU 048 scheme &#34;&#34; not registered, fallback to default scheme
2018-08-07 02:45:36.287 UTC [grpc] Printf -&gt; DEBU 049 ccResolverWrapper: sending new addresses to cc: [{orderer0.jicki.cn:7050 0  &lt;nil&gt;}]
2018-08-07 02:45:36.287 UTC [grpc] Printf -&gt; DEBU 04a ClientConn switching balancer to &#34;pick_first&#34;
2018-08-07 02:45:36.287 UTC [grpc] Printf -&gt; DEBU 04b pickfirstBalancer: HandleSubConnStateChange: 0xc42025aed0, CONNECTING
2018-08-07 02:45:36.287 UTC [grpc] Printf -&gt; DEBU 04c pickfirstBalancer: HandleSubConnStateChange: 0xc42025aed0, READY
2018-08-07 02:45:36.314 UTC [channelCmd] update -&gt; INFO 04d Successfully submitted channel update

</code></pre></td></tr></table></div></div><h2 id=hyperledger-fabric-实例化测试>Hyperledger Fabric 实例化测试</h2><blockquote><p>在上面我们已经拷贝了官方的例子，在 chaincode 下, 下面我们来测试一下</p></blockquote><h3 id=安装智能合约>安装智能合约</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-go data-lang=go><span class=err>#</span> <span class=nx>cli</span> <span class=nx>部分</span>  <span class=p>.</span><span class=o>/</span><span class=nx>chaincode</span><span class=o>/</span><span class=k>go</span><span class=o>/</span><span class=p>:</span><span class=o>/</span><span class=nx>opt</span><span class=o>/</span><span class=nx>gopath</span><span class=o>/</span><span class=nx>src</span><span class=o>/</span><span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>hyperledger</span><span class=o>/</span><span class=nx>fabric</span><span class=o>/</span><span class=nx>jicki</span><span class=o>/</span><span class=nx>chaincode</span><span class=o>/</span><span class=k>go</span>
<span class=err>#</span> <span class=nx>为</span> <span class=nx>智能合约的目录</span> <span class=nx>我们约定为这个目录</span> <span class=nx>需要预先创建</span> 


<span class=nx>mkdir</span> <span class=o>-</span><span class=nx>p</span> <span class=o>/</span><span class=nx>opt</span><span class=o>/</span><span class=nx>jicki</span><span class=o>/</span><span class=nx>chaincode</span><span class=o>/</span><span class=k>go</span>

<span class=nx>cd</span> <span class=o>/</span><span class=nx>opt</span><span class=o>/</span><span class=nx>jicki</span><span class=o>/</span><span class=nx>chaincode</span><span class=o>/</span><span class=k>go</span>

<span class=err>#</span> <span class=nx>创建以后</span><span class=err>~</span><span class=nx>我们拷贝官方的</span> <span class=nx>例子进来</span><span class=err>，</span><span class=nx>方便后面进行合约测试</span>

<span class=nx>cp</span> <span class=o>-</span><span class=nx>r</span> <span class=o>/</span><span class=nx>opt</span><span class=o>/</span><span class=nx>gopath</span><span class=o>/</span><span class=nx>src</span><span class=o>/</span><span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>hyperledger</span><span class=o>/</span><span class=nx>fabric</span><span class=o>/</span><span class=nx>examples</span><span class=o>/</span><span class=nx>chaincode</span><span class=o>/</span><span class=k>go</span><span class=o>/</span><span class=nx>example0</span><span class=o>*</span> <span class=o>/</span><span class=nx>opt</span><span class=o>/</span><span class=nx>jicki</span><span class=o>/</span><span class=nx>chaincode</span><span class=o>/</span><span class=k>go</span><span class=o>/</span>


<span class=err>#</span> <span class=nx>官方这里有5个例子</span>

<span class=p>[</span><span class=nx>root</span><span class=err>@</span><span class=nx>localhost</span> <span class=nx>jicki</span><span class=p>]</span><span class=err>#</span> <span class=nx>ls</span> <span class=o>-</span><span class=nx>lt</span> <span class=nx>chaincode</span><span class=o>/</span><span class=k>go</span><span class=o>/</span>
<span class=nx>total</span> <span class=mi>20</span>
<span class=nx>drwxr</span><span class=o>-</span><span class=nx>xr</span><span class=o>-</span><span class=nx>x</span> <span class=mi>3</span> <span class=nx>root</span> <span class=nx>root</span> <span class=mi>4096</span> <span class=nx>Aug</span>  <span class=mi>7</span> <span class=mi>10</span><span class=p>:</span><span class=mi>46</span> <span class=nx>example01</span>
<span class=nx>drwxr</span><span class=o>-</span><span class=nx>xr</span><span class=o>-</span><span class=nx>x</span> <span class=mi>3</span> <span class=nx>root</span> <span class=nx>root</span> <span class=mi>4096</span> <span class=nx>Aug</span>  <span class=mi>7</span> <span class=mi>10</span><span class=p>:</span><span class=mi>46</span> <span class=nx>example02</span>
<span class=nx>drwxr</span><span class=o>-</span><span class=nx>xr</span><span class=o>-</span><span class=nx>x</span> <span class=mi>3</span> <span class=nx>root</span> <span class=nx>root</span> <span class=mi>4096</span> <span class=nx>Aug</span>  <span class=mi>7</span> <span class=mi>10</span><span class=p>:</span><span class=mi>46</span> <span class=nx>example03</span>
<span class=nx>drwxr</span><span class=o>-</span><span class=nx>xr</span><span class=o>-</span><span class=nx>x</span> <span class=mi>3</span> <span class=nx>root</span> <span class=nx>root</span> <span class=mi>4096</span> <span class=nx>Aug</span>  <span class=mi>7</span> <span class=mi>10</span><span class=p>:</span><span class=mi>46</span> <span class=nx>example04</span>
<span class=nx>drwxr</span><span class=o>-</span><span class=nx>xr</span><span class=o>-</span><span class=nx>x</span> <span class=mi>3</span> <span class=nx>root</span> <span class=nx>root</span> <span class=mi>4096</span> <span class=nx>Aug</span>  <span class=mi>7</span> <span class=mi>10</span><span class=p>:</span><span class=mi>46</span> <span class=nx>example05</span>



<span class=err>#</span> <span class=nx>如上我们挂载的地址为</span> <span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>hyperledger</span><span class=o>/</span><span class=nx>fabric</span><span class=o>/</span><span class=nx>jicki</span><span class=o>/</span><span class=nx>chaincode</span><span class=o>/</span><span class=k>go</span>


<span class=err>#</span> <span class=nx>注</span><span class=p>:</span> <span class=nx>这里面的</span> <span class=nx>example02</span> <span class=nx>的</span> <span class=kn>package</span> <span class=nx>为</span> <span class=nx>example02</span> <span class=nx>会报错</span>

<span class=nx>Error</span><span class=p>:</span> <span class=nx>could</span> <span class=nx>not</span> <span class=nx>assemble</span> <span class=nx>transaction</span><span class=p>,</span> <span class=nx>err</span> <span class=nx>Proposal</span> <span class=nx>response</span> <span class=nx>was</span> <span class=nx>not</span> <span class=nx>successful</span><span class=p>,</span> <span class=kt>error</span> <span class=nx>code</span> <span class=mi>500</span><span class=p>,</span> <span class=nx>msg</span> <span class=nx>failed</span> <span class=nx>to</span> <span class=nx>execute</span> <span class=nx>transaction</span> <span class=mi>819</span><span class=nx>b581ce88604e9b6651764324876f2ca7a47d7aeb7ee307f273af867a4a134</span><span class=p>:</span> <span class=kt>error</span> <span class=nx>starting</span> <span class=nx>container</span><span class=p>:</span> <span class=kt>error</span> <span class=nx>starting</span> <span class=nx>container</span><span class=p>:</span> <span class=nx>API</span> <span class=kt>error</span> <span class=p>(</span><span class=mi>404</span><span class=p>):</span> <span class=nx>oci</span> <span class=nx>runtime</span> <span class=kt>error</span><span class=p>:</span> <span class=nx>container_linux</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>247</span><span class=p>:</span> <span class=nx>starting</span> <span class=nx>container</span> <span class=nx>process</span> <span class=nx>caused</span> <span class=s>&#34;exec: \&#34;chaincode\&#34;: executable file not found in $PATH&#34;</span>


<span class=err>#</span> <span class=nx>将</span> <span class=nx>chaincode</span><span class=p>.</span><span class=k>go</span>  <span class=nx>chaincode_test</span><span class=p>.</span><span class=k>go</span> <span class=nx>中</span>  <span class=kn>package</span> <span class=nx>修改成</span> <span class=nx>main</span> <span class=nx>然后在最下面增加</span> <span class=nf>main</span><span class=p>()</span><span class=nx>函数</span>

<span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
        <span class=nx>err</span> <span class=o>:=</span> <span class=nx>shim</span><span class=p>.</span><span class=nf>Start</span><span class=p>(</span><span class=nb>new</span><span class=p>(</span><span class=nx>SimpleChaincode</span><span class=p>))</span>
        <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
                <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Error starting Simple chaincode: %s&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
        <span class=p>}</span>
<span class=p>}</span>

</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-go data-lang=go><span class=err>#</span> <span class=nx>安装指定合约到</span> <span class=nx>所有的</span> <span class=nx>peer</span> <span class=nx>节点中</span><span class=err>，</span><span class=nx>每个节点都必须安装一次</span>

<span class=err>#</span> <span class=nx>同样需要先配置变量</span>

<span class=nx>export</span> <span class=nx>CORE_PEER_LOCALMSPID</span><span class=p>=</span><span class=s>&#34;Org1MSP&#34;</span>
<span class=nx>export</span> <span class=nx>CORE_PEER_ADDRESS</span><span class=p>=</span><span class=nx>peer0</span><span class=p>.</span><span class=nx>org1</span><span class=p>.</span><span class=nx>jicki</span><span class=p>.</span><span class=nx>cn</span><span class=p>:</span><span class=mi>7051</span>
<span class=nx>export</span> <span class=nx>CORE_PEER_TLS_ROOTCERT_FILE</span><span class=p>=</span><span class=o>/</span><span class=nx>opt</span><span class=o>/</span><span class=nx>gopath</span><span class=o>/</span><span class=nx>src</span><span class=o>/</span><span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>hyperledger</span><span class=o>/</span><span class=nx>fabric</span><span class=o>/</span><span class=nx>peer</span><span class=o>/</span><span class=nx>crypto</span><span class=o>/</span><span class=nx>peerOrganizations</span><span class=o>/</span><span class=nx>org1</span><span class=p>.</span><span class=nx>jicki</span><span class=p>.</span><span class=nx>cn</span><span class=o>/</span><span class=nx>peers</span><span class=o>/</span><span class=nx>peer0</span><span class=p>.</span><span class=nx>org1</span><span class=p>.</span><span class=nx>jicki</span><span class=p>.</span><span class=nx>cn</span><span class=o>/</span><span class=nx>tls</span><span class=o>/</span><span class=nx>ca</span><span class=p>.</span><span class=nx>crt</span>
<span class=nx>export</span> <span class=nx>CORE_PEER_MSPCONFIGPATH</span><span class=p>=</span><span class=o>/</span><span class=nx>opt</span><span class=o>/</span><span class=nx>gopath</span><span class=o>/</span><span class=nx>src</span><span class=o>/</span><span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>hyperledger</span><span class=o>/</span><span class=nx>fabric</span><span class=o>/</span><span class=nx>peer</span><span class=o>/</span><span class=nx>crypto</span><span class=o>/</span><span class=nx>peerOrganizations</span><span class=o>/</span><span class=nx>org1</span><span class=p>.</span><span class=nx>jicki</span><span class=p>.</span><span class=nx>cn</span><span class=o>/</span><span class=nx>users</span><span class=o>/</span><span class=nx>Admin</span><span class=err>@</span><span class=nx>org1</span><span class=p>.</span><span class=nx>jicki</span><span class=p>.</span><span class=nx>cn</span><span class=o>/</span><span class=nx>msp</span>



<span class=err>#</span> <span class=nx>安装</span> <span class=nx>合约</span>

<span class=nx>peer</span> <span class=nx>chaincode</span> <span class=nx>install</span> <span class=o>-</span><span class=nx>n</span> <span class=nx>example2</span> <span class=o>-</span><span class=nx>p</span> <span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>hyperledger</span><span class=o>/</span><span class=nx>fabric</span><span class=o>/</span><span class=nx>jicki</span><span class=o>/</span><span class=nx>chaincode</span><span class=o>/</span><span class=k>go</span><span class=o>/</span><span class=nx>example02</span> <span class=o>-</span><span class=nx>v</span> <span class=mf>1.0</span>   



<span class=err>#</span> <span class=nx>输出如下</span><span class=p>:</span>

<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.296</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>msp</span><span class=p>]</span> <span class=nx>setupSigningIdentity</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>035</span> <span class=nx>Signing</span> <span class=nx>identity</span> <span class=nx>expires</span> <span class=nx>at</span> <span class=mi>2028</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>03</span> <span class=mo>06</span><span class=p>:</span><span class=mi>40</span><span class=p>:</span><span class=mi>54</span> <span class=o>+</span><span class=mo>0000</span> <span class=nx>UTC</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.296</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>msp</span><span class=p>]</span> <span class=nx>Validate</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>036</span> <span class=nx>MSP</span> <span class=nx>Org1MSP</span> <span class=nx>validating</span> <span class=nx>identity</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.297</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>037</span> <span class=nx>parsed</span> <span class=nx>scheme</span><span class=p>:</span> <span class=s>&#34;&#34;</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.297</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>03</span><span class=mi>8</span> <span class=nx>scheme</span> <span class=s>&#34;&#34;</span> <span class=nx>not</span> <span class=nx>registered</span><span class=p>,</span> <span class=nx>fallback</span> <span class=nx>to</span> <span class=k>default</span> <span class=nx>scheme</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.297</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>03</span><span class=mi>9</span> <span class=nx>ccResolverWrapper</span><span class=p>:</span> <span class=nx>sending</span> <span class=nx>new</span> <span class=nx>addresses</span> <span class=nx>to</span> <span class=nx>cc</span><span class=p>:</span> <span class=p>[{</span><span class=nx>peer0</span><span class=p>.</span><span class=nx>org1</span><span class=p>.</span><span class=nx>jicki</span><span class=p>.</span><span class=nx>cn</span><span class=p>:</span><span class=mi>7051</span> <span class=mi>0</span>  <span class=p>&lt;</span><span class=kc>nil</span><span class=p>&gt;}]</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.297</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>03</span><span class=nx>a</span> <span class=nx>ClientConn</span> <span class=nx>switching</span> <span class=nx>balancer</span> <span class=nx>to</span> <span class=s>&#34;pick_first&#34;</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.297</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>03</span><span class=nx>b</span> <span class=nx>pickfirstBalancer</span><span class=p>:</span> <span class=nx>HandleSubConnStateChange</span><span class=p>:</span> <span class=mh>0xc42049c2f0</span><span class=p>,</span> <span class=nx>CONNECTING</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.298</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>03</span><span class=nx>c</span> <span class=nx>pickfirstBalancer</span><span class=p>:</span> <span class=nx>HandleSubConnStateChange</span><span class=p>:</span> <span class=mh>0xc42049c2f0</span><span class=p>,</span> <span class=nx>READY</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.298</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>03</span><span class=nx>d</span> <span class=nx>parsed</span> <span class=nx>scheme</span><span class=p>:</span> <span class=s>&#34;&#34;</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.298</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>03</span><span class=nx>e</span> <span class=nx>scheme</span> <span class=s>&#34;&#34;</span> <span class=nx>not</span> <span class=nx>registered</span><span class=p>,</span> <span class=nx>fallback</span> <span class=nx>to</span> <span class=k>default</span> <span class=nx>scheme</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.298</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>03</span><span class=nx>f</span> <span class=nx>ccResolverWrapper</span><span class=p>:</span> <span class=nx>sending</span> <span class=nx>new</span> <span class=nx>addresses</span> <span class=nx>to</span> <span class=nx>cc</span><span class=p>:</span> <span class=p>[{</span><span class=nx>peer0</span><span class=p>.</span><span class=nx>org1</span><span class=p>.</span><span class=nx>jicki</span><span class=p>.</span><span class=nx>cn</span><span class=p>:</span><span class=mi>7051</span> <span class=mi>0</span>  <span class=p>&lt;</span><span class=kc>nil</span><span class=p>&gt;}]</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.298</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>040</span> <span class=nx>ClientConn</span> <span class=nx>switching</span> <span class=nx>balancer</span> <span class=nx>to</span> <span class=s>&#34;pick_first&#34;</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.299</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>041</span> <span class=nx>pickfirstBalancer</span><span class=p>:</span> <span class=nx>HandleSubConnStateChange</span><span class=p>:</span> <span class=mh>0xc4202ce020</span><span class=p>,</span> <span class=nx>CONNECTING</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.299</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>042</span> <span class=nx>pickfirstBalancer</span><span class=p>:</span> <span class=nx>HandleSubConnStateChange</span><span class=p>:</span> <span class=mh>0xc4202ce020</span><span class=p>,</span> <span class=nx>READY</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.300</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>msp</span><span class=p>]</span> <span class=nx>GetDefaultSigningIdentity</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>043</span> <span class=nx>Obtaining</span> <span class=k>default</span> <span class=nx>signing</span> <span class=nx>identity</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.300</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>chaincodeCmd</span><span class=p>]</span> <span class=nx>checkChaincodeCmdParams</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>INFO</span> <span class=mo>044</span> <span class=nx>Using</span> <span class=k>default</span> <span class=nx>escc</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.300</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>chaincodeCmd</span><span class=p>]</span> <span class=nx>checkChaincodeCmdParams</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>INFO</span> <span class=mo>045</span> <span class=nx>Using</span> <span class=k>default</span> <span class=nx>vscc</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.300</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>chaincodeCmd</span><span class=p>]</span> <span class=nx>getChaincodeSpec</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>046</span> <span class=nx>java</span> <span class=nx>chaincode</span> <span class=nx>disabled</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.338</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>golang</span><span class=o>-</span><span class=nx>platform</span><span class=p>]</span> <span class=nx>getCodeFromFS</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>047</span> <span class=nx>getCodeFromFS</span> <span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>hyperledger</span><span class=o>/</span><span class=nx>fabric</span><span class=o>/</span><span class=nx>jicki</span><span class=o>/</span><span class=nx>chaincode</span><span class=o>/</span><span class=k>go</span><span class=o>/</span><span class=nx>example02</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.450</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>golang</span><span class=o>-</span><span class=nx>platform</span><span class=p>]</span> <span class=nx>func1</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>04</span><span class=mi>8</span> <span class=nx>Discarding</span> <span class=nx>GOROOT</span> <span class=kn>package</span> <span class=nx>fmt</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.450</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>golang</span><span class=o>-</span><span class=nx>platform</span><span class=p>]</span> <span class=nx>func1</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>04</span><span class=mi>9</span> <span class=nx>Discarding</span> <span class=nx>provided</span> <span class=kn>package</span> <span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>hyperledger</span><span class=o>/</span><span class=nx>fabric</span><span class=o>/</span><span class=nx>core</span><span class=o>/</span><span class=nx>chaincode</span><span class=o>/</span><span class=nx>shim</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.450</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>golang</span><span class=o>-</span><span class=nx>platform</span><span class=p>]</span> <span class=nx>func1</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>04</span><span class=nx>a</span> <span class=nx>Discarding</span> <span class=nx>provided</span> <span class=kn>package</span> <span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>hyperledger</span><span class=o>/</span><span class=nx>fabric</span><span class=o>/</span><span class=nx>protos</span><span class=o>/</span><span class=nx>peer</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.450</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>golang</span><span class=o>-</span><span class=nx>platform</span><span class=p>]</span> <span class=nx>func1</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>04</span><span class=nx>b</span> <span class=nx>Discarding</span> <span class=nx>GOROOT</span> <span class=kn>package</span> <span class=nx>strconv</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.450</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>golang</span><span class=o>-</span><span class=nx>platform</span><span class=p>]</span> <span class=nx>func1</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>04</span><span class=nx>c</span> <span class=nx>skipping</span> <span class=nx>dir</span><span class=p>:</span> <span class=o>/</span><span class=nx>opt</span><span class=o>/</span><span class=nx>gopath</span><span class=o>/</span><span class=nx>src</span><span class=o>/</span><span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>hyperledger</span><span class=o>/</span><span class=nx>fabric</span><span class=o>/</span><span class=nx>jicki</span><span class=o>/</span><span class=nx>chaincode</span><span class=o>/</span><span class=k>go</span><span class=o>/</span><span class=nx>example02</span><span class=o>/</span><span class=nx>cmd</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.451</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>golang</span><span class=o>-</span><span class=nx>platform</span><span class=p>]</span> <span class=nx>GetDeploymentPayload</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>04</span><span class=nx>d</span> <span class=nx>done</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.451</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>container</span><span class=p>]</span> <span class=nx>WriteFileToPackage</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>04</span><span class=nx>e</span> <span class=nx>Writing</span> <span class=nx>file</span> <span class=nx>to</span> <span class=nx>tarball</span><span class=p>:</span> <span class=nx>src</span><span class=o>/</span><span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>hyperledger</span><span class=o>/</span><span class=nx>fabric</span><span class=o>/</span><span class=nx>jicki</span><span class=o>/</span><span class=nx>chaincode</span><span class=o>/</span><span class=k>go</span><span class=o>/</span><span class=nx>example02</span><span class=o>/</span><span class=nx>chaincode</span><span class=p>.</span><span class=k>go</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.451</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>container</span><span class=p>]</span> <span class=nx>WriteFileToPackage</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>04</span><span class=nx>f</span> <span class=nx>Writing</span> <span class=nx>file</span> <span class=nx>to</span> <span class=nx>tarball</span><span class=p>:</span> <span class=nx>src</span><span class=o>/</span><span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>hyperledger</span><span class=o>/</span><span class=nx>fabric</span><span class=o>/</span><span class=nx>jicki</span><span class=o>/</span><span class=nx>chaincode</span><span class=o>/</span><span class=k>go</span><span class=o>/</span><span class=nx>example02</span><span class=o>/</span><span class=nx>chaincode_test</span><span class=p>.</span><span class=k>go</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.452</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>msp</span><span class=o>/</span><span class=nx>identity</span><span class=p>]</span> <span class=nx>Sign</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>050</span> <span class=nx>Sign</span><span class=p>:</span> <span class=nx>plaintext</span><span class=p>:</span> <span class=mi>0</span><span class=nx>A98070A5C08031A0C08E590A4DB0510</span><span class=o>...</span><span class=nx>C7F84F000000FFFFEB6FF30D00280000</span> 
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.452</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>msp</span><span class=o>/</span><span class=nx>identity</span><span class=p>]</span> <span class=nx>Sign</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>051</span> <span class=nx>Sign</span><span class=p>:</span> <span class=nx>digest</span><span class=p>:</span> <span class=mi>4</span><span class=nx>CBC4EA6119D83478DB9214C41CAFB439A4D5CE4C955B0989F4AA07B94238B1B</span> 
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>05.469</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>chaincodeCmd</span><span class=p>]</span> <span class=nx>install</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>INFO</span> <span class=mo>052</span> <span class=nx>Installed</span> <span class=nx>remotely</span> <span class=nx>response</span><span class=p>:&lt;</span><span class=nx>status</span><span class=p>:</span><span class=mi>200</span> <span class=nx>payload</span><span class=p>:</span><span class=s>&#34;OK&#34;</span> <span class=p>&gt;</span> 

</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-go data-lang=go><span class=err>#</span> <span class=nx>安装指定合约到</span> <span class=nx>所有的</span> <span class=nx>peer</span> <span class=nx>节点中</span><span class=err>，</span><span class=nx>每个节点都必须安装一次</span>

<span class=err>#</span> <span class=nx>同样需要先配置变量</span>

<span class=nx>export</span> <span class=nx>CORE_PEER_LOCALMSPID</span><span class=p>=</span><span class=s>&#34;Org2MSP&#34;</span>
<span class=nx>export</span> <span class=nx>CORE_PEER_ADDRESS</span><span class=p>=</span><span class=nx>peer0</span><span class=p>.</span><span class=nx>org2</span><span class=p>.</span><span class=nx>jicki</span><span class=p>.</span><span class=nx>cn</span><span class=p>:</span><span class=mi>7051</span>
<span class=nx>export</span> <span class=nx>CORE_PEER_TLS_ROOTCERT_FILE</span><span class=p>=</span><span class=o>/</span><span class=nx>opt</span><span class=o>/</span><span class=nx>gopath</span><span class=o>/</span><span class=nx>src</span><span class=o>/</span><span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>hyperledger</span><span class=o>/</span><span class=nx>fabric</span><span class=o>/</span><span class=nx>peer</span><span class=o>/</span><span class=nx>crypto</span><span class=o>/</span><span class=nx>peerOrganizations</span><span class=o>/</span><span class=nx>org2</span><span class=p>.</span><span class=nx>jicki</span><span class=p>.</span><span class=nx>cn</span><span class=o>/</span><span class=nx>peers</span><span class=o>/</span><span class=nx>peer0</span><span class=p>.</span><span class=nx>org2</span><span class=p>.</span><span class=nx>jicki</span><span class=p>.</span><span class=nx>cn</span><span class=o>/</span><span class=nx>tls</span><span class=o>/</span><span class=nx>ca</span><span class=p>.</span><span class=nx>crt</span>
<span class=nx>export</span> <span class=nx>CORE_PEER_MSPCONFIGPATH</span><span class=p>=</span><span class=o>/</span><span class=nx>opt</span><span class=o>/</span><span class=nx>gopath</span><span class=o>/</span><span class=nx>src</span><span class=o>/</span><span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>hyperledger</span><span class=o>/</span><span class=nx>fabric</span><span class=o>/</span><span class=nx>peer</span><span class=o>/</span><span class=nx>crypto</span><span class=o>/</span><span class=nx>peerOrganizations</span><span class=o>/</span><span class=nx>org2</span><span class=p>.</span><span class=nx>jicki</span><span class=p>.</span><span class=nx>cn</span><span class=o>/</span><span class=nx>users</span><span class=o>/</span><span class=nx>Admin</span><span class=err>@</span><span class=nx>org2</span><span class=p>.</span><span class=nx>jicki</span><span class=p>.</span><span class=nx>cn</span><span class=o>/</span><span class=nx>msp</span>



<span class=err>#</span> <span class=nx>安装</span> <span class=nx>合约</span>

<span class=nx>peer</span> <span class=nx>chaincode</span> <span class=nx>install</span> <span class=o>-</span><span class=nx>n</span> <span class=nx>example2</span> <span class=o>-</span><span class=nx>p</span> <span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>hyperledger</span><span class=o>/</span><span class=nx>fabric</span><span class=o>/</span><span class=nx>jicki</span><span class=o>/</span><span class=nx>chaincode</span><span class=o>/</span><span class=k>go</span><span class=o>/</span><span class=nx>example02</span> <span class=o>-</span><span class=nx>v</span> <span class=mf>1.0</span>  



<span class=err>#</span> <span class=nx>输出如下</span><span class=p>:</span>

<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.440</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>msp</span><span class=p>]</span> <span class=nx>setupSigningIdentity</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>035</span> <span class=nx>Signing</span> <span class=nx>identity</span> <span class=nx>expires</span> <span class=nx>at</span> <span class=mi>2028</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>03</span> <span class=mo>06</span><span class=p>:</span><span class=mi>40</span><span class=p>:</span><span class=mi>54</span> <span class=o>+</span><span class=mo>0000</span> <span class=nx>UTC</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.441</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>msp</span><span class=p>]</span> <span class=nx>Validate</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>036</span> <span class=nx>MSP</span> <span class=nx>Org2MSP</span> <span class=nx>validating</span> <span class=nx>identity</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.441</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>037</span> <span class=nx>parsed</span> <span class=nx>scheme</span><span class=p>:</span> <span class=s>&#34;&#34;</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.441</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>03</span><span class=mi>8</span> <span class=nx>scheme</span> <span class=s>&#34;&#34;</span> <span class=nx>not</span> <span class=nx>registered</span><span class=p>,</span> <span class=nx>fallback</span> <span class=nx>to</span> <span class=k>default</span> <span class=nx>scheme</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.441</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>03</span><span class=mi>9</span> <span class=nx>ccResolverWrapper</span><span class=p>:</span> <span class=nx>sending</span> <span class=nx>new</span> <span class=nx>addresses</span> <span class=nx>to</span> <span class=nx>cc</span><span class=p>:</span> <span class=p>[{</span><span class=nx>peer0</span><span class=p>.</span><span class=nx>org2</span><span class=p>.</span><span class=nx>jicki</span><span class=p>.</span><span class=nx>cn</span><span class=p>:</span><span class=mi>7051</span> <span class=mi>0</span>  <span class=p>&lt;</span><span class=kc>nil</span><span class=p>&gt;}]</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.441</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>03</span><span class=nx>a</span> <span class=nx>ClientConn</span> <span class=nx>switching</span> <span class=nx>balancer</span> <span class=nx>to</span> <span class=s>&#34;pick_first&#34;</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.441</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>03</span><span class=nx>b</span> <span class=nx>pickfirstBalancer</span><span class=p>:</span> <span class=nx>HandleSubConnStateChange</span><span class=p>:</span> <span class=mh>0xc420229510</span><span class=p>,</span> <span class=nx>CONNECTING</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.442</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>03</span><span class=nx>c</span> <span class=nx>pickfirstBalancer</span><span class=p>:</span> <span class=nx>HandleSubConnStateChange</span><span class=p>:</span> <span class=mh>0xc420229510</span><span class=p>,</span> <span class=nx>READY</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.442</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>03</span><span class=nx>d</span> <span class=nx>parsed</span> <span class=nx>scheme</span><span class=p>:</span> <span class=s>&#34;&#34;</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.442</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>03</span><span class=nx>e</span> <span class=nx>scheme</span> <span class=s>&#34;&#34;</span> <span class=nx>not</span> <span class=nx>registered</span><span class=p>,</span> <span class=nx>fallback</span> <span class=nx>to</span> <span class=k>default</span> <span class=nx>scheme</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.442</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>03</span><span class=nx>f</span> <span class=nx>ccResolverWrapper</span><span class=p>:</span> <span class=nx>sending</span> <span class=nx>new</span> <span class=nx>addresses</span> <span class=nx>to</span> <span class=nx>cc</span><span class=p>:</span> <span class=p>[{</span><span class=nx>peer0</span><span class=p>.</span><span class=nx>org2</span><span class=p>.</span><span class=nx>jicki</span><span class=p>.</span><span class=nx>cn</span><span class=p>:</span><span class=mi>7051</span> <span class=mi>0</span>  <span class=p>&lt;</span><span class=kc>nil</span><span class=p>&gt;}]</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.442</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>040</span> <span class=nx>ClientConn</span> <span class=nx>switching</span> <span class=nx>balancer</span> <span class=nx>to</span> <span class=s>&#34;pick_first&#34;</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.443</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>041</span> <span class=nx>pickfirstBalancer</span><span class=p>:</span> <span class=nx>HandleSubConnStateChange</span><span class=p>:</span> <span class=mh>0xc4202b8a20</span><span class=p>,</span> <span class=nx>CONNECTING</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.443</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>grpc</span><span class=p>]</span> <span class=nx>Printf</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>042</span> <span class=nx>pickfirstBalancer</span><span class=p>:</span> <span class=nx>HandleSubConnStateChange</span><span class=p>:</span> <span class=mh>0xc4202b8a20</span><span class=p>,</span> <span class=nx>READY</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.444</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>msp</span><span class=p>]</span> <span class=nx>GetDefaultSigningIdentity</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>043</span> <span class=nx>Obtaining</span> <span class=k>default</span> <span class=nx>signing</span> <span class=nx>identity</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.444</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>chaincodeCmd</span><span class=p>]</span> <span class=nx>checkChaincodeCmdParams</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>INFO</span> <span class=mo>044</span> <span class=nx>Using</span> <span class=k>default</span> <span class=nx>escc</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.444</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>chaincodeCmd</span><span class=p>]</span> <span class=nx>checkChaincodeCmdParams</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>INFO</span> <span class=mo>045</span> <span class=nx>Using</span> <span class=k>default</span> <span class=nx>vscc</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.444</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>chaincodeCmd</span><span class=p>]</span> <span class=nx>getChaincodeSpec</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>046</span> <span class=nx>java</span> <span class=nx>chaincode</span> <span class=nx>disabled</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.481</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>golang</span><span class=o>-</span><span class=nx>platform</span><span class=p>]</span> <span class=nx>getCodeFromFS</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>047</span> <span class=nx>getCodeFromFS</span> <span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>hyperledger</span><span class=o>/</span><span class=nx>fabric</span><span class=o>/</span><span class=nx>jicki</span><span class=o>/</span><span class=nx>chaincode</span><span class=o>/</span><span class=k>go</span><span class=o>/</span><span class=nx>example02</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.588</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>golang</span><span class=o>-</span><span class=nx>platform</span><span class=p>]</span> <span class=nx>func1</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>04</span><span class=mi>8</span> <span class=nx>Discarding</span> <span class=nx>GOROOT</span> <span class=kn>package</span> <span class=nx>fmt</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.588</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>golang</span><span class=o>-</span><span class=nx>platform</span><span class=p>]</span> <span class=nx>func1</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>04</span><span class=mi>9</span> <span class=nx>Discarding</span> <span class=nx>provided</span> <span class=kn>package</span> <span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>hyperledger</span><span class=o>/</span><span class=nx>fabric</span><span class=o>/</span><span class=nx>core</span><span class=o>/</span><span class=nx>chaincode</span><span class=o>/</span><span class=nx>shim</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.588</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>golang</span><span class=o>-</span><span class=nx>platform</span><span class=p>]</span> <span class=nx>func1</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>04</span><span class=nx>a</span> <span class=nx>Discarding</span> <span class=nx>provided</span> <span class=kn>package</span> <span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>hyperledger</span><span class=o>/</span><span class=nx>fabric</span><span class=o>/</span><span class=nx>protos</span><span class=o>/</span><span class=nx>peer</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.588</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>golang</span><span class=o>-</span><span class=nx>platform</span><span class=p>]</span> <span class=nx>func1</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>04</span><span class=nx>b</span> <span class=nx>Discarding</span> <span class=nx>GOROOT</span> <span class=kn>package</span> <span class=nx>strconv</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.588</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>golang</span><span class=o>-</span><span class=nx>platform</span><span class=p>]</span> <span class=nx>func1</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>04</span><span class=nx>c</span> <span class=nx>skipping</span> <span class=nx>dir</span><span class=p>:</span> <span class=o>/</span><span class=nx>opt</span><span class=o>/</span><span class=nx>gopath</span><span class=o>/</span><span class=nx>src</span><span class=o>/</span><span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>hyperledger</span><span class=o>/</span><span class=nx>fabric</span><span class=o>/</span><span class=nx>jicki</span><span class=o>/</span><span class=nx>chaincode</span><span class=o>/</span><span class=k>go</span><span class=o>/</span><span class=nx>example02</span><span class=o>/</span><span class=nx>cmd</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.588</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>golang</span><span class=o>-</span><span class=nx>platform</span><span class=p>]</span> <span class=nx>GetDeploymentPayload</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>04</span><span class=nx>d</span> <span class=nx>done</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.588</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>container</span><span class=p>]</span> <span class=nx>WriteFileToPackage</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>04</span><span class=nx>e</span> <span class=nx>Writing</span> <span class=nx>file</span> <span class=nx>to</span> <span class=nx>tarball</span><span class=p>:</span> <span class=nx>src</span><span class=o>/</span><span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>hyperledger</span><span class=o>/</span><span class=nx>fabric</span><span class=o>/</span><span class=nx>jicki</span><span class=o>/</span><span class=nx>chaincode</span><span class=o>/</span><span class=k>go</span><span class=o>/</span><span class=nx>example02</span><span class=o>/</span><span class=nx>chaincode</span><span class=p>.</span><span class=k>go</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.589</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>container</span><span class=p>]</span> <span class=nx>WriteFileToPackage</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>04</span><span class=nx>f</span> <span class=nx>Writing</span> <span class=nx>file</span> <span class=nx>to</span> <span class=nx>tarball</span><span class=p>:</span> <span class=nx>src</span><span class=o>/</span><span class=nx>github</span><span class=p>.</span><span class=nx>com</span><span class=o>/</span><span class=nx>hyperledger</span><span class=o>/</span><span class=nx>fabric</span><span class=o>/</span><span class=nx>jicki</span><span class=o>/</span><span class=nx>chaincode</span><span class=o>/</span><span class=k>go</span><span class=o>/</span><span class=nx>example02</span><span class=o>/</span><span class=nx>chaincode_test</span><span class=p>.</span><span class=k>go</span>
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.589</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>msp</span><span class=o>/</span><span class=nx>identity</span><span class=p>]</span> <span class=nx>Sign</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>050</span> <span class=nx>Sign</span><span class=p>:</span> <span class=nx>plaintext</span><span class=p>:</span> <span class=mi>0</span><span class=nx>A98070A5C08031A0C08F890A4DB0510</span><span class=o>...</span><span class=nx>C7F84F000000FFFFEB6FF30D00280000</span> 
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.589</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>msp</span><span class=o>/</span><span class=nx>identity</span><span class=p>]</span> <span class=nx>Sign</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>DEBU</span> <span class=mo>051</span> <span class=nx>Sign</span><span class=p>:</span> <span class=nx>digest</span><span class=p>:</span> <span class=mi>8322</span><span class=nx>AEA3AA9478AC330B78C685B29F2FD85505EBC838DB13A71BEB58AFD822B9</span> 
<span class=mi>2018</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mo>07</span> <span class=mo>02</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mf>24.606</span> <span class=nx>UTC</span> <span class=p>[</span><span class=nx>chaincodeCmd</span><span class=p>]</span> <span class=nx>install</span> <span class=o>-</span><span class=p>&gt;</span> <span class=nx>INFO</span> <span class=mo>052</span> <span class=nx>Installed</span> <span class=nx>remotely</span> <span class=nx>response</span><span class=p>:&lt;</span><span class=nx>status</span><span class=p>:</span><span class=mi>200</span> <span class=nx>payload</span><span class=p>:</span><span class=s>&#34;OK&#34;</span> <span class=p>&gt;</span> 

</code></pre></td></tr></table></div></div><h3 id=实例化-chaincode>实例化 Chaincode</h3><blockquote><p>这里无论多少个 peer 节点, 实例化只需要实例化一次，就可以。</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 实例化合约 (未认证)
peer chaincode instantiate -o orderer0.jicki.cn:7050 -C mychannel -n example2 -c &#39;{&#34;Args&#34;:[&#34;init&#34;,&#34;A&#34;,&#34;200&#34;,&#34;B&#34;,&#34;500&#34;]}&#39; -P &#34;OR (&#39;Org1MSP.member&#39;,&#39;Org2MSP.member&#39;)&#34; -v 1.0



# 实例化合约 (已认证)
peer chaincode instantiate -o orderer0.jicki.cn:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/jicki.cn/orderers/orderer0.jicki.cn/msp/tlscacerts/tlsca.jicki.cn-cert.pem -C mychannel -n example2 -c &#39;{&#34;Args&#34;:[&#34;init&#34;,&#34;A&#34;,&#34;100&#34;,&#34;B&#34;,&#34;50&#34;]}&#39; -P &#34;OR (&#39;Org1MSP.member&#39;,&#39;Org2MSP.member&#39;)&#34; -v 1.0




# 输出如下:

2018-08-07 02:49:00.544 UTC [msp] setupSigningIdentity -&gt; DEBU 035 Signing identity expires at 2028-08-03 06:40:54 +0000 UTC
2018-08-07 02:49:00.544 UTC [msp] Validate -&gt; DEBU 036 MSP Org1MSP validating identity
2018-08-07 02:49:00.545 UTC [grpc] Printf -&gt; DEBU 037 parsed scheme: &#34;&#34;
2018-08-07 02:49:00.545 UTC [grpc] Printf -&gt; DEBU 038 scheme &#34;&#34; not registered, fallback to default scheme
2018-08-07 02:49:00.545 UTC [grpc] Printf -&gt; DEBU 039 ccResolverWrapper: sending new addresses to cc: [{peer0.org1.jicki.cn:7051 0  &lt;nil&gt;}]
2018-08-07 02:49:00.545 UTC [grpc] Printf -&gt; DEBU 03a ClientConn switching balancer to &#34;pick_first&#34;
2018-08-07 02:49:00.545 UTC [grpc] Printf -&gt; DEBU 03b pickfirstBalancer: HandleSubConnStateChange: 0xc4204ca910, CONNECTING
2018-08-07 02:49:00.546 UTC [grpc] Printf -&gt; DEBU 03c pickfirstBalancer: HandleSubConnStateChange: 0xc4204ca910, READY
2018-08-07 02:49:00.546 UTC [grpc] Printf -&gt; DEBU 03d parsed scheme: &#34;&#34;
2018-08-07 02:49:00.546 UTC [grpc] Printf -&gt; DEBU 03e scheme &#34;&#34; not registered, fallback to default scheme
2018-08-07 02:49:00.546 UTC [grpc] Printf -&gt; DEBU 03f ccResolverWrapper: sending new addresses to cc: [{peer0.org1.jicki.cn:7051 0  &lt;nil&gt;}]
2018-08-07 02:49:00.546 UTC [grpc] Printf -&gt; DEBU 040 ClientConn switching balancer to &#34;pick_first&#34;
2018-08-07 02:49:00.547 UTC [grpc] Printf -&gt; DEBU 041 pickfirstBalancer: HandleSubConnStateChange: 0xc420549310, CONNECTING
2018-08-07 02:49:00.548 UTC [grpc] Printf -&gt; DEBU 042 pickfirstBalancer: HandleSubConnStateChange: 0xc420549310, READY
2018-08-07 02:49:00.548 UTC [msp] GetDefaultSigningIdentity -&gt; DEBU 043 Obtaining default signing identity
2018-08-07 02:49:00.548 UTC [grpc] Printf -&gt; DEBU 044 parsed scheme: &#34;&#34;
2018-08-07 02:49:00.548 UTC [grpc] Printf -&gt; DEBU 045 scheme &#34;&#34; not registered, fallback to default scheme
2018-08-07 02:49:00.548 UTC [grpc] Printf -&gt; DEBU 046 ccResolverWrapper: sending new addresses to cc: [{orderer0.jicki.cn:7050 0  &lt;nil&gt;}]
2018-08-07 02:49:00.548 UTC [grpc] Printf -&gt; DEBU 047 ClientConn switching balancer to &#34;pick_first&#34;
2018-08-07 02:49:00.548 UTC [grpc] Printf -&gt; DEBU 048 pickfirstBalancer: HandleSubConnStateChange: 0xc42006b380, CONNECTING
2018-08-07 02:49:00.548 UTC [grpc] Printf -&gt; DEBU 049 pickfirstBalancer: HandleSubConnStateChange: 0xc42006b380, READY
2018-08-07 02:49:00.548 UTC [chaincodeCmd] checkChaincodeCmdParams -&gt; INFO 04a Using default escc
2018-08-07 02:49:00.548 UTC [chaincodeCmd] checkChaincodeCmdParams -&gt; INFO 04b Using default vscc
2018-08-07 02:49:00.549 UTC [chaincodeCmd] getChaincodeSpec -&gt; DEBU 04c java chaincode disabled
2018-08-07 02:49:00.549 UTC [msp/identity] Sign -&gt; DEBU 04d Sign: plaintext: 0AA3070A6708031A0C089C91A4DB0510...324D53500A04657363630A0476736363 
2018-08-07 02:49:00.549 UTC [msp/identity] Sign -&gt; DEBU 04e Sign: digest: 1852003550AFAEB4A9DD2F01A3F4DA89346E64FCC1B6056D45CCC297A9763A1F 
2018-08-07 02:49:13.285 UTC [msp/identity] Sign -&gt; DEBU 04f Sign: plaintext: 0AA3070A6708031A0C089C91A4DB0510...46C5367A5E41CCC7C4704B72B4D5F2D4 
2018-08-07 02:49:13.285 UTC [msp/identity] Sign -&gt; DEBU 050 Sign: digest: 8D57F12A907CA041F15725217B3EC56FC52C2E4A5A9FF8578FD90C18AC65F817 

</code></pre></td></tr></table></div></div><h3 id=操作智能合约>操作智能合约</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># query 查询方法


# 查询 A 账户里的余额

peer chaincode query -C mychannel -n example2 -c &#39;{&#34;Args&#34;:[&#34;query&#34;,&#34;A&#34;]}&#39;


# 输出如下:

2018-08-07 02:49:40.807 UTC [msp] setupSigningIdentity -&gt; DEBU 035 Signing identity expires at 2028-08-03 06:40:54 +0000 UTC
2018-08-07 02:49:40.807 UTC [msp] Validate -&gt; DEBU 036 MSP Org1MSP validating identity
2018-08-07 02:49:40.807 UTC [grpc] Printf -&gt; DEBU 037 parsed scheme: &#34;&#34;
2018-08-07 02:49:40.807 UTC [grpc] Printf -&gt; DEBU 038 scheme &#34;&#34; not registered, fallback to default scheme
2018-08-07 02:49:40.807 UTC [grpc] Printf -&gt; DEBU 039 ccResolverWrapper: sending new addresses to cc: [{peer0.org1.jicki.cn:7051 0  &lt;nil&gt;}]
2018-08-07 02:49:40.807 UTC [grpc] Printf -&gt; DEBU 03a ClientConn switching balancer to &#34;pick_first&#34;
2018-08-07 02:49:40.808 UTC [grpc] Printf -&gt; DEBU 03b pickfirstBalancer: HandleSubConnStateChange: 0xc4201b5510, CONNECTING
2018-08-07 02:49:40.809 UTC [grpc] Printf -&gt; DEBU 03c pickfirstBalancer: HandleSubConnStateChange: 0xc4201b5510, READY
2018-08-07 02:49:40.809 UTC [grpc] Printf -&gt; DEBU 03d parsed scheme: &#34;&#34;
2018-08-07 02:49:40.809 UTC [grpc] Printf -&gt; DEBU 03e scheme &#34;&#34; not registered, fallback to default scheme
2018-08-07 02:49:40.809 UTC [grpc] Printf -&gt; DEBU 03f ccResolverWrapper: sending new addresses to cc: [{peer0.org1.jicki.cn:7051 0  &lt;nil&gt;}]
2018-08-07 02:49:40.809 UTC [grpc] Printf -&gt; DEBU 040 ClientConn switching balancer to &#34;pick_first&#34;
2018-08-07 02:49:40.809 UTC [grpc] Printf -&gt; DEBU 041 pickfirstBalancer: HandleSubConnStateChange: 0xc420232a20, CONNECTING
2018-08-07 02:49:40.809 UTC [grpc] Printf -&gt; DEBU 042 pickfirstBalancer: HandleSubConnStateChange: 0xc420232a20, READY
2018-08-07 02:49:40.811 UTC [msp] GetDefaultSigningIdentity -&gt; DEBU 043 Obtaining default signing identity
2018-08-07 02:49:40.811 UTC [chaincodeCmd] getChaincodeSpec -&gt; DEBU 044 java chaincode disabled
2018-08-07 02:49:40.811 UTC [msp/identity] Sign -&gt; DEBU 045 Sign: plaintext: 0AA7070A6B08031A0C08C491A4DB0510...706C65321A0A0A0571756572790A0141 
2018-08-07 02:49:40.811 UTC [msp/identity] Sign -&gt; DEBU 046 Sign: digest: CD3360D1248F37AC518F8B9D55B46BA976526A6D115AE68A2EC3A93423C22D7C 
200


# 可以看到 返回 200
</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 查询 B 账户里的余额

peer chaincode query -C mychannel -n example2 -c &#39;{&#34;Args&#34;:[&#34;query&#34;,&#34;B&#34;]}&#39;


# 输出如下:

2018-08-07 02:50:09.596 UTC [msp] setupSigningIdentity -&gt; DEBU 035 Signing identity expires at 2028-08-03 06:40:54 +0000 UTC
2018-08-07 02:50:09.596 UTC [msp] Validate -&gt; DEBU 036 MSP Org1MSP validating identity
2018-08-07 02:50:09.597 UTC [grpc] Printf -&gt; DEBU 037 parsed scheme: &#34;&#34;
2018-08-07 02:50:09.597 UTC [grpc] Printf -&gt; DEBU 038 scheme &#34;&#34; not registered, fallback to default scheme
2018-08-07 02:50:09.597 UTC [grpc] Printf -&gt; DEBU 039 ccResolverWrapper: sending new addresses to cc: [{peer0.org1.jicki.cn:7051 0  &lt;nil&gt;}]
2018-08-07 02:50:09.597 UTC [grpc] Printf -&gt; DEBU 03a ClientConn switching balancer to &#34;pick_first&#34;
2018-08-07 02:50:09.597 UTC [grpc] Printf -&gt; DEBU 03b pickfirstBalancer: HandleSubConnStateChange: 0xc42053fc70, CONNECTING
2018-08-07 02:50:09.597 UTC [grpc] Printf -&gt; DEBU 03c pickfirstBalancer: HandleSubConnStateChange: 0xc42053fc70, READY
2018-08-07 02:50:09.598 UTC [grpc] Printf -&gt; DEBU 03d parsed scheme: &#34;&#34;
2018-08-07 02:50:09.598 UTC [grpc] Printf -&gt; DEBU 03e scheme &#34;&#34; not registered, fallback to default scheme
2018-08-07 02:50:09.598 UTC [grpc] Printf -&gt; DEBU 03f ccResolverWrapper: sending new addresses to cc: [{peer0.org1.jicki.cn:7051 0  &lt;nil&gt;}]
2018-08-07 02:50:09.598 UTC [grpc] Printf -&gt; DEBU 040 ClientConn switching balancer to &#34;pick_first&#34;
2018-08-07 02:50:09.598 UTC [grpc] Printf -&gt; DEBU 041 pickfirstBalancer: HandleSubConnStateChange: 0xc420247180, CONNECTING
2018-08-07 02:50:09.599 UTC [grpc] Printf -&gt; DEBU 042 pickfirstBalancer: HandleSubConnStateChange: 0xc420247180, READY
2018-08-07 02:50:09.599 UTC [msp] GetDefaultSigningIdentity -&gt; DEBU 043 Obtaining default signing identity
2018-08-07 02:50:09.599 UTC [chaincodeCmd] getChaincodeSpec -&gt; DEBU 044 java chaincode disabled
2018-08-07 02:50:09.599 UTC [msp/identity] Sign -&gt; DEBU 045 Sign: plaintext: 0AA7070A6B08031A0C08E191A4DB0510...706C65321A0A0A0571756572790A0142 
2018-08-07 02:50:09.599 UTC [msp/identity] Sign -&gt; DEBU 046 Sign: digest: 1C28B767E687B1C2D9CCE05C14735F2C8D250BA3C8442F3EB077BADFCFB1D65B 
500


# 可以看到 返回 500

</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># invoke 转账方法


# 从A账户 转账 20 个币 到 B 账户


peer chaincode invoke -C mychannel -n example2 -c &#39;{&#34;Args&#34;:[&#34;invoke&#34;, &#34;A&#34;, &#34;B&#34;, &#34;100&#34;]}&#39;


# 输出如下:

2018-08-07 02:50:40.962 UTC [grpc] Printf -&gt; DEBU 0bf parsed scheme: &#34;&#34;
2018-08-07 02:50:40.962 UTC [grpc] Printf -&gt; DEBU 0c0 scheme &#34;&#34; not registered, fallback to default scheme
2018-08-07 02:50:40.962 UTC [grpc] Printf -&gt; DEBU 0c1 ccResolverWrapper: sending new addresses to cc: [{orderer0.jicki.cn:7050 0  &lt;nil&gt;}]
2018-08-07 02:50:40.962 UTC [grpc] Printf -&gt; DEBU 0c2 ClientConn switching balancer to &#34;pick_first&#34;
2018-08-07 02:50:40.962 UTC [grpc] Printf -&gt; DEBU 0c3 pickfirstBalancer: HandleSubConnStateChange: 0xc4202e6bc0, CONNECTING
2018-08-07 02:50:40.963 UTC [grpc] Printf -&gt; DEBU 0c4 pickfirstBalancer: HandleSubConnStateChange: 0xc4202e6bc0, READY
2018-08-07 02:50:40.963 UTC [chaincodeCmd] getChaincodeSpec -&gt; DEBU 0c5 java chaincode disabled
2018-08-07 02:50:40.963 UTC [msp/identity] Sign -&gt; DEBU 0c6 Sign: plaintext: 0AA7070A6B08031A0C088092A4DB0510...6E766F6B650A01410A01420A03313030 
2018-08-07 02:50:40.963 UTC [msp/identity] Sign -&gt; DEBU 0c7 Sign: digest: A9C3D9F911BBD38516C15CC0AABF05588F4EDCBE8686AFA59947A62EE12F41F4 
2018-08-07 02:50:40.972 UTC [msp/identity] Sign -&gt; DEBU 0c8 Sign: plaintext: 0AA7070A6B08031A0C088092A4DB0510...8144630C48C565D11D1AA2562DB4FB70 
2018-08-07 02:50:40.972 UTC [msp/identity] Sign -&gt; DEBU 0c9 Sign: digest: 0E9C53305451D3168CA61B8E525C416822E24A4C2C57ECE908C51C7A3F671B8D 
2018-08-07 02:50:40.978 UTC [chaincodeCmd] chaincodeInvokeOrQuery -&gt; DEBU 0ca ESCC invoke result: version:1 response:&lt;status:200 &gt; payload:&#34;\n ~\303\035uF\270\254\024\3655\272|.\006\217\362}\242\340\311\270_\354}\353q\303Y\324\352J\000\022f\nN\0222\n\010example2\022&amp;\n\007\n\001A\022\002\010\003\n\007\n\001B\022\002\010\003\032\010\n\001A\032\003100\032\010\n\001B\032\003600\022\030\n\004lscc\022\020\n\016\n\010example2\022\002\010\003\032\003\010\310\001\&#34;\017\022\010example2\032\0031.0&#34; endorsement:&lt;endorser:&#34;\n\007Org1MSP\022\216\006-----BEGIN CERTIFICATE-----\nMIICEzCCAbqgAwIBAgIRALNKLIQGXYydTA4WqXE0UUwwCgYIKoZIzj0EAwIwZzEL\nMAkGA1UEBhMCQ04xEjAQBgNVBAgTCUd1YW5nRG9uZzERMA8GA1UEBxMIU2hlblpo\nZW4xFjAUBgNVBAoTDW9yZzEuamlja2kubWUxGTAXBgNVBAMTEGNhLm9yZzEuamlj\na2kubWUwHhcNMTgwODA2MDY0MDU0WhcNMjgwODAzMDY0MDU0WjBhMQswCQYDVQQG\nEwJDTjESMBAGA1UECBMJR3VhbmdEb25nMREwDwYDVQQHEwhTaGVuWmhlbjENMAsG\nA1UECxMEcGVlcjEcMBoGA1UEAxMTcGVlcjAub3JnMS5qaWNraS5tZTBZMBMGByqG\nSM49AgEGCCqGSM49AwEHA0IABIJsThrTC3lNx4L97bB7YopOLaQNoCXhi/KAeMur\neYOchSQh3LbTb2dvf9hlW1DlN5y+QjrxAo9QNn6/fMk74uGjTTBLMA4GA1UdDwEB\n/wQEAwIHgDAMBgNVHRMBAf8EAjAAMCsGA1UdIwQkMCKAIExyclAVcPAhAWcUhubH\njfdv0sZOnU6wmqcDppjwTTFZMAoGCCqGSM49BAMCA0cAMEQCIEFjh/Q1281Puzjg\n7c5/BhCv8+HvDM8lQZ3kHV3CQzTsAiAJ2cWndgCLFoXqiCqo1xzEcEHNO1O9c9sn\ngnPbCBvW4g==\n-----END CERTIFICATE-----\n&#34; signature:&#34;0E\002!\000\241\244i\001\225.y1e\225@\261\003\322\275\326\013[\364\304Ri7I\304\024\361#\\_J`\002 e\310\335&amp;\241\376\270EHh4\246\010Y\264\270\201Dc\014H\305e\321\035\032\242V-\264\373p&#34; &gt; 
2018-08-07 02:50:40.978 UTC [chaincodeCmd] chaincodeInvokeOrQuery -&gt; INFO 0cb Chaincode invoke successful. result: status:200



# 可以看到返回 invoke successful. result: status:200 成功
</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 这里再查询 A 与 B 的账户

# A 账户余额 

peer chaincode query -C mychannel -n example2 -c &#39;{&#34;Args&#34;:[&#34;query&#34;,&#34;A&#34;]}&#39;  


# 输出如下:

2018-08-07 02:51:09.356 UTC [msp] setupSigningIdentity -&gt; DEBU 035 Signing identity expires at 2028-08-03 06:40:54 +0000 UTC
2018-08-07 02:51:09.356 UTC [msp] Validate -&gt; DEBU 036 MSP Org1MSP validating identity
2018-08-07 02:51:09.357 UTC [grpc] Printf -&gt; DEBU 037 parsed scheme: &#34;&#34;
2018-08-07 02:51:09.357 UTC [grpc] Printf -&gt; DEBU 038 scheme &#34;&#34; not registered, fallback to default scheme
2018-08-07 02:51:09.357 UTC [grpc] Printf -&gt; DEBU 039 ccResolverWrapper: sending new addresses to cc: [{peer0.org1.jicki.cn:7051 0  &lt;nil&gt;}]
2018-08-07 02:51:09.357 UTC [grpc] Printf -&gt; DEBU 03a ClientConn switching balancer to &#34;pick_first&#34;
2018-08-07 02:51:09.357 UTC [grpc] Printf -&gt; DEBU 03b pickfirstBalancer: HandleSubConnStateChange: 0xc420533510, CONNECTING
2018-08-07 02:51:09.358 UTC [grpc] Printf -&gt; DEBU 03c pickfirstBalancer: HandleSubConnStateChange: 0xc420533510, READY
2018-08-07 02:51:09.358 UTC [grpc] Printf -&gt; DEBU 03d parsed scheme: &#34;&#34;
2018-08-07 02:51:09.358 UTC [grpc] Printf -&gt; DEBU 03e scheme &#34;&#34; not registered, fallback to default scheme
2018-08-07 02:51:09.358 UTC [grpc] Printf -&gt; DEBU 03f ccResolverWrapper: sending new addresses to cc: [{peer0.org1.jicki.cn:7051 0  &lt;nil&gt;}]
2018-08-07 02:51:09.358 UTC [grpc] Printf -&gt; DEBU 040 ClientConn switching balancer to &#34;pick_first&#34;
2018-08-07 02:51:09.359 UTC [grpc] Printf -&gt; DEBU 041 pickfirstBalancer: HandleSubConnStateChange: 0xc4205db310, CONNECTING
2018-08-07 02:51:09.359 UTC [grpc] Printf -&gt; DEBU 042 pickfirstBalancer: HandleSubConnStateChange: 0xc4205db310, READY
2018-08-07 02:51:09.360 UTC [msp] GetDefaultSigningIdentity -&gt; DEBU 043 Obtaining default signing identity
2018-08-07 02:51:09.360 UTC [chaincodeCmd] getChaincodeSpec -&gt; DEBU 044 java chaincode disabled
2018-08-07 02:51:09.360 UTC [msp/identity] Sign -&gt; DEBU 045 Sign: plaintext: 0AA7070A6B08031A0C089D92A4DB0510...706C65321A0A0A0571756572790A0141 
2018-08-07 02:51:09.360 UTC [msp/identity] Sign -&gt; DEBU 046 Sign: digest: 4551936C8DDCEC3821AB6868B5D9162D86B31B32E1A34585CC3E70B06C717C83 
100
</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># B 账户余额 

peer chaincode query -C mychannel -n example2 -c &#39;{&#34;Args&#34;:[&#34;query&#34;,&#34;B&#34;]}&#39;   



# 输出如下:

2018-08-07 02:51:34.433 UTC [msp] setupSigningIdentity -&gt; DEBU 035 Signing identity expires at 2028-08-03 06:40:54 +0000 UTC
2018-08-07 02:51:34.433 UTC [msp] Validate -&gt; DEBU 036 MSP Org1MSP validating identity
2018-08-07 02:51:34.434 UTC [grpc] Printf -&gt; DEBU 037 parsed scheme: &#34;&#34;
2018-08-07 02:51:34.434 UTC [grpc] Printf -&gt; DEBU 038 scheme &#34;&#34; not registered, fallback to default scheme
2018-08-07 02:51:34.434 UTC [grpc] Printf -&gt; DEBU 039 ccResolverWrapper: sending new addresses to cc: [{peer0.org1.jicki.cn:7051 0  &lt;nil&gt;}]
2018-08-07 02:51:34.434 UTC [grpc] Printf -&gt; DEBU 03a ClientConn switching balancer to &#34;pick_first&#34;
2018-08-07 02:51:34.434 UTC [grpc] Printf -&gt; DEBU 03b pickfirstBalancer: HandleSubConnStateChange: 0xc4202e7150, CONNECTING
2018-08-07 02:51:34.435 UTC [grpc] Printf -&gt; DEBU 03c pickfirstBalancer: HandleSubConnStateChange: 0xc4202e7150, READY
2018-08-07 02:51:34.435 UTC [grpc] Printf -&gt; DEBU 03d parsed scheme: &#34;&#34;
2018-08-07 02:51:34.435 UTC [grpc] Printf -&gt; DEBU 03e scheme &#34;&#34; not registered, fallback to default scheme
2018-08-07 02:51:34.435 UTC [grpc] Printf -&gt; DEBU 03f ccResolverWrapper: sending new addresses to cc: [{peer0.org1.jicki.cn:7051 0  &lt;nil&gt;}]
2018-08-07 02:51:34.435 UTC [grpc] Printf -&gt; DEBU 040 ClientConn switching balancer to &#34;pick_first&#34;
2018-08-07 02:51:34.435 UTC [grpc] Printf -&gt; DEBU 041 pickfirstBalancer: HandleSubConnStateChange: 0xc42050a660, CONNECTING
2018-08-07 02:51:34.436 UTC [grpc] Printf -&gt; DEBU 042 pickfirstBalancer: HandleSubConnStateChange: 0xc42050a660, READY
2018-08-07 02:51:34.437 UTC [msp] GetDefaultSigningIdentity -&gt; DEBU 043 Obtaining default signing identity
2018-08-07 02:51:34.437 UTC [chaincodeCmd] getChaincodeSpec -&gt; DEBU 044 java chaincode disabled
2018-08-07 02:51:34.437 UTC [msp/identity] Sign -&gt; DEBU 045 Sign: plaintext: 0AA7070A6B08031A0C08B692A4DB0510...706C65321A0A0A0571756572790A0142 
2018-08-07 02:51:34.437 UTC [msp/identity] Sign -&gt; DEBU 046 Sign: digest: EE474CDC8DD863E3F9163AE8A73CE43EF25C9FF417DD940EE133BDC1A6646CB8 
600

</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 查看 peer0.org1.jicki.cn 节点里 生成的容器

[root@localhost jicki]# docker ps -a
CONTAINER ID        IMAGE                                                                                                     COMMAND                  CREATED             STATUS              PORTS                                                                                         NAMES
ddb72b9ca769        jicki-peer0.org1.jicki.cn-example2-1.0-58e362edb293b97212b572bd603337608795d8168a8a3632d2a14ac12fa6ae70   &#34;chaincode -peer.add…&#34;   2 minutes ago       Up 2 minutes                                                                                                      jicki-peer0.org1.jicki.cn-example2-1.0

</code></pre></td></tr></table></div></div><h2 id=hyperledger-fabric-操作命令>Hyperledger Fabric 操作命令</h2><h3 id=peer-命令>peer 命令</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>peer chaincode          # 对链进行操作
peer channel            # channel相关操作
peer logging            # 设置日志级别
peer node               # 启动、管理节点
peer version            # 查看版本信息

</code></pre></td></tr></table></div></div><blockquote><p>upgrade 更新合约 更新合约相当于将合约重新实例化，并带有一个新的版本号。</p><p>更新合约之前，需要在所有的 peer节点 上安装(install)最新的合约，并使用新的版本号。</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 更新合约

# 首先安装(install)新的合约, 以本文为例, chaincode_example02, 初次安装版本号为 1.0 

peer chaincode install -n example2 -p github.com/hyperledger/fabric/jicki/chaincode/go/chaincode_example02 -v 1.1


# 更新版本为 1.1 的合约
peer chaincode upgrade -o orderer0.jicki.cn:7050 -C mychannel -n example2 -c &#39;{&#34;Args&#34;:[&#34;init&#34;,&#34;A&#34;,&#34;100&#34;,&#34;B&#34;,&#34;50&#34;]}&#39; -P &#34;OR (&#39;Org1MSP.member&#39;,&#39;Org2MSP.member&#39;)&#34; -v 1.1


# 旧版本的合约, 目前，fabric不支持合约的启动与暂停。要暂停或删除合约，只能到peer上手动删除容器。

</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 查看 已经创建的 通道 (channel)

peer channel  list


# 查看通道(channel) 的状态 -c(小写) 加 通道名称

peer channel getinfo -c mychannel


# 查看已经 安装的 智能合约(chincode)

peer chaincode  list --installed


# 查看已经 实例化的 智能合约(chincode) 需要使用 -C(大写) 加通道名称

peer chaincode -C mychannel list --instantiated

</code></pre></td></tr></table></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2018-08-07</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/hyperledger-fabric-1.2/index.md target=_blank>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=https://jicki.cn/hyperledger-fabric-1.2/ data-title="hyperledger-fabric v 1.2 多机 多节点" data-via=jicki234><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://jicki.cn/hyperledger-fabric-1.2/><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="分享到 WhatsApp" data-sharer=whatsapp data-url=https://jicki.cn/hyperledger-fabric-1.2/ data-title="hyperledger-fabric v 1.2 多机 多节点" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href=javascript:void(0); title="分享到 Line" data-sharer=line data-url=https://jicki.cn/hyperledger-fabric-1.2/ data-title="hyperledger-fabric v 1.2 多机 多节点"><i data-svg-src=/lib/simple-icons/icons/line.min.svg></i></a><a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://jicki.cn/hyperledger-fabric-1.2/ data-title="hyperledger-fabric v 1.2 多机 多节点"><i class="fab fa-weibo fa-fw"></i></a><a href=javascript:void(0); title="分享到 Myspace" data-sharer=myspace data-url=https://jicki.cn/hyperledger-fabric-1.2/ data-title="hyperledger-fabric v 1.2 多机 多节点" data-description="hyperledger-fabric v 1.2 多机多节点"><i data-svg-src=/lib/simple-icons/icons/myspace.min.svg></i></a><a href=javascript:void(0); title="分享到 Blogger" data-sharer=blogger data-url=https://jicki.cn/hyperledger-fabric-1.2/ data-title="hyperledger-fabric v 1.2 多机 多节点" data-description="hyperledger-fabric v 1.2 多机多节点"><i class="fab fa-blogger fa-fw"></i></a><a href=javascript:void(0); title="分享到 Evernote" data-sharer=evernote data-url=https://jicki.cn/hyperledger-fabric-1.2/ data-title="hyperledger-fabric v 1.2 多机 多节点"><i class="fab fa-evernote fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back();>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/kubernetes-1.11.0/ class=prev rel=prev title="kubernetes 1.11.0"><i class="fas fa-angle-left fa-fw"></i>kubernetes 1.11.0</a>
<a href=/kubernetes-1.11.2/ class=next rel=next title="kubernetes 1.11.2">kubernetes 1.11.2<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=valine class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://valine.js.org/>Valine</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>由 <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.73.0">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i>LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2020</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://jicki.cn target=_blank>小炒肉</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span><span class=icp-splitter>&nbsp;|&nbsp;</span><br class=icp-br><span class=icp>粤ICP备20055633号</span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw"></i></a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=/lib/valine/valine.min.css><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/katex/copy-tex.min.css><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script type=text/javascript src=/lib/valine/Valine.min.js></script><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lunr/lunr.stemmer.support.min.js></script><script type=text/javascript src=/lib/lunr/lunr.zh.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/auto-render.min.js></script><script type=text/javascript src=/lib/katex/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/mhchem.min.js></script><script type=text/javascript src=/lib/cookieconsent/cookieconsent.min.js></script><script type=text/javascript>window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":50},"comment":{"valine":{"appId":"","appKey":"","avatar":"mp","el":"#valine","emojiCDN":"https://cdn.jsdelivr.net/npm/emoji-datasource-google@5.0.1/img/google/64/","emojiMaps":{"100":"1f4af.png","alien":"1f47d.png","anger":"1f4a2.png","angry":"1f620.png","anguished":"1f627.png","astonished":"1f632.png","black_heart":"1f5a4.png","blue_heart":"1f499.png","blush":"1f60a.png","bomb":"1f4a3.png","boom":"1f4a5.png","broken_heart":"1f494.png","brown_heart":"1f90e.png","clown_face":"1f921.png","cold_face":"1f976.png","cold_sweat":"1f630.png","confounded":"1f616.png","confused":"1f615.png","cry":"1f622.png","crying_cat_face":"1f63f.png","cupid":"1f498.png","dash":"1f4a8.png","disappointed":"1f61e.png","disappointed_relieved":"1f625.png","dizzy":"1f4ab.png","dizzy_face":"1f635.png","drooling_face":"1f924.png","exploding_head":"1f92f.png","expressionless":"1f611.png","face_vomiting":"1f92e.png","face_with_cowboy_hat":"1f920.png","face_with_hand_over_mouth":"1f92d.png","face_with_head_bandage":"1f915.png","face_with_monocle":"1f9d0.png","face_with_raised_eyebrow":"1f928.png","face_with_rolling_eyes":"1f644.png","face_with_symbols_on_mouth":"1f92c.png","face_with_thermometer":"1f912.png","fearful":"1f628.png","flushed":"1f633.png","frowning":"1f626.png","ghost":"1f47b.png","gift_heart":"1f49d.png","green_heart":"1f49a.png","grimacing":"1f62c.png","grin":"1f601.png","grinning":"1f600.png","hankey":"1f4a9.png","hear_no_evil":"1f649.png","heart":"2764-fe0f.png","heart_decoration":"1f49f.png","heart_eyes":"1f60d.png","heart_eyes_cat":"1f63b.png","heartbeat":"1f493.png","heartpulse":"1f497.png","heavy_heart_exclamation_mark_ornament":"2763-fe0f.png","hole":"1f573-fe0f.png","hot_face":"1f975.png","hugging_face":"1f917.png","hushed":"1f62f.png","imp":"1f47f.png","innocent":"1f607.png","japanese_goblin":"1f47a.png","japanese_ogre":"1f479.png","joy":"1f602.png","joy_cat":"1f639.png","kiss":"1f48b.png","kissing":"1f617.png","kissing_cat":"1f63d.png","kissing_closed_eyes":"1f61a.png","kissing_heart":"1f618.png","kissing_smiling_eyes":"1f619.png","laughing":"1f606.png","left_speech_bubble":"1f5e8-fe0f.png","love_letter":"1f48c.png","lying_face":"1f925.png","mask":"1f637.png","money_mouth_face":"1f911.png","nauseated_face":"1f922.png","nerd_face":"1f913.png","neutral_face":"1f610.png","no_mouth":"1f636.png","open_mouth":"1f62e.png","orange_heart":"1f9e1.png","partying_face":"1f973.png","pensive":"1f614.png","persevere":"1f623.png","pleading_face":"1f97a.png","pouting_cat":"1f63e.png","purple_heart":"1f49c.png","rage":"1f621.png","relaxed":"263a-fe0f.png","relieved":"1f60c.png","revolving_hearts":"1f49e.png","right_anger_bubble":"1f5ef-fe0f.png","robot_face":"1f916.png","rolling_on_the_floor_laughing":"1f923.png","scream":"1f631.png","scream_cat":"1f640.png","see_no_evil":"1f648.png","shushing_face":"1f92b.png","skull":"1f480.png","skull_and_crossbones":"2620-fe0f.png","sleeping":"1f634.png","sleepy":"1f62a.png","slightly_frowning_face":"1f641.png","slightly_smiling_face":"1f642.png","smile":"1f604.png","smile_cat":"1f638.png","smiley":"1f603.png","smiley_cat":"1f63a.png","smiling_face_with_3_hearts":"1f970.png","smiling_imp":"1f608.png","smirk":"1f60f.png","smirk_cat":"1f63c.png","sneezing_face":"1f927.png","sob":"1f62d.png","space_invader":"1f47e.png","sparkling_heart":"1f496.png","speak_no_evil":"1f64a.png","speech_balloon":"1f4ac.png","star-struck":"1f929.png","stuck_out_tongue":"1f61b.png","stuck_out_tongue_closed_eyes":"1f61d.png","stuck_out_tongue_winking_eye":"1f61c.png","sunglasses":"1f60e.png","sweat":"1f613.png","sweat_drops":"1f4a6.png","sweat_smile":"1f605.png","thinking_face":"1f914.png","thought_balloon":"1f4ad.png","tired_face":"1f62b.png","triumph":"1f624.png","two_hearts":"1f495.png","unamused":"1f612.png","upside_down_face":"1f643.png","weary":"1f629.png","white_frowning_face":"2639-fe0f.png","white_heart":"1f90d.png","wink":"1f609.png","woozy_face":"1f974.png","worried":"1f61f.png","yawning_face":"1f971.png","yellow_heart":"1f49b.png","yum":"1f60b.png","zany_face":"1f92a.png","zipper_mouth_face":"1f910.png","zzz":"1f4a4.png"},"enableQQ":false,"highlight":true,"lang":"zh-cn","pageSize":10,"placeholder":"你的评论 ...","recordIP":true,"visitor":true}},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"lunr"}};</script><script type=text/javascript src=/js/theme.min.js></script></body></html>